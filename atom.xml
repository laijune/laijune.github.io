<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Xiaolai Blog</title>
  
  
  <link href="https://laijune.github.io/atom.xml" rel="self"/>
  
  <link href="https://laijune.github.io/"/>
  <updated>2022-12-12T14:02:02.000Z</updated>
  <id>https://laijune.github.io/</id>
  
  <author>
    <name>imlai</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Kubernetes é›†ç¾¤éƒ¨ç½²</title>
    <link href="https://laijune.github.io/2022/11/23/Kubernetes%20Deploy/"/>
    <id>https://laijune.github.io/2022/11/23/Kubernetes%20Deploy/</id>
    <published>2022-11-23T07:00:00.000Z</published>
    <updated>2022-12-12T14:02:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Kubernetes-é›†ç¾¤éƒ¨ç½²"><a href="#Kubernetes-é›†ç¾¤éƒ¨ç½²" class="headerlink" title="Kubernetes é›†ç¾¤éƒ¨ç½²"></a>Kubernetes é›†ç¾¤éƒ¨ç½²</h1><h2 id="ç¯å¢ƒä»‹ç»"><a href="#ç¯å¢ƒä»‹ç»" class="headerlink" title="ç¯å¢ƒä»‹ç»"></a>ç¯å¢ƒä»‹ç»</h2><p>4 å°è™šæ‹Ÿæœºï¼Œ1 å° masterï¼Œ2 å° nodeï¼Œ1 å° utility æ˜¯è´Ÿè´£æä¾›ç½‘å…³å’Œé›†ç¾¤å†…éƒ¨é€šä¿¡</p><p><strong>masterï¼š</strong>192.168.19.101/24        ä¸»æœºåï¼šcka-1</p><p><strong>node1ï¼š</strong>  192.168.19.102/24        ä¸»æœºåï¼šcka-2    </p><p><strong>node2ï¼š</strong>  192.168.19.103/24        ä¸»æœºåï¼šcka-3</p><p><strong>utilityï¼š</strong>  10.0.0.133/24ï¼ˆNAT ç½‘å…³ï¼Œè¿é€šå¤–ç½‘ï¼‰ï¼›192.168.19.254/24ï¼ˆå®ç°é›†ç¾¤é—´é€šä¿¡ï¼‰</p><blockquote><p>utility ç³»ç»Ÿæ˜¯ <strong>CentOS 7</strong>ï¼Œk8s é›†ç¾¤ç³»ç»Ÿæ˜¯ <strong>Ubuntu</strong> 20.04.2 LTS</p><p>utility æ˜¯ä½œä¸ºå®¢æˆ·ç«¯è¿œç¨‹åˆ° k8s é›†ç¾¤çš„è·³æ¿æœºå’Œå……å½“ç½‘å…³åŠŸèƒ½ï¼›åŒç½‘å¡èƒ½è®© k8s é›†ç¾¤ä¹‹é—´äº’ç›¸é€šä¿¡ï¼Œä¹Ÿèƒ½å®ç°é›†ç¾¤è¿é€šå¤–ç½‘</p></blockquote><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><span id="more"></span><p><strong>å…³é—­ swap äº¤æ¢åˆ†åŒº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">ç™»å½•åˆ°master(cka-1)</span><br><span class="line">[student@utility ~]$ ssh root@cka-1</span><br><span class="line"></span><br><span class="line">root@cka-1:~<span class="comment"># vim /etc/fstab </span></span><br><span class="line"><span class="comment"># /etc/fstab: static file system information.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span></span><br><span class="line"><span class="comment"># device; this may be used with UUID= as a more robust way to name devices</span></span><br><span class="line"><span class="comment"># that works even if disks are added and removed. See fstab(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span></span><br><span class="line"><span class="comment"># / was on /dev/sda2 during curtin installation</span></span><br><span class="line">/dev/disk/by-uuid/aabac2dc-9464-4ed0-ae98-37700ee61cf8 / ext4 defaults 0 0</span><br><span class="line"><span class="comment">#/swap.img      none    swap    sw      0       0ğŸ‘ˆæ³¨é‡Šswapä¸€è¡Œ</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹swapè®¾å¤‡çš„ä¿¡æ¯</span><br><span class="line">root@cka-1:~<span class="comment"># swapon -s</span></span><br><span class="line">FilenameTypeSizeUsedPriority</span><br><span class="line">/swap.img                              file    40017880-2</span><br><span class="line"></span><br><span class="line">ç¦ç”¨swapåˆ†åŒº</span><br><span class="line">root@cka-1:~<span class="comment"># swapoff /swap.img </span></span><br><span class="line"></span><br><span class="line">å†æ¬¡æŸ¥çœ‹swapä¿¡æ¯,æ­¤æ—¶å°±æ²¡æœ‰swapçš„è®¾å¤‡äº†</span><br><span class="line">root@cka-1:~<span class="comment"># swapon -s</span></span><br><span class="line"></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br></pre></td></tr></table></figure><p><strong>è·¯ç”±è½¬å‘</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®ç³»ç»Ÿå†…æ ¸å‚æ•°</span><br><span class="line">root@cka-1:~<span class="comment"># vim /etc/sysctl.d/docker.conf</span></span><br><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line"></span><br><span class="line">åŠ è½½æ¨¡å—</span><br><span class="line">root@cka-1:~<span class="comment"># modprobe br_netfilter </span></span><br><span class="line"></span><br><span class="line">åŠ è½½é…ç½®æ–‡ä»¶</span><br><span class="line">root@cka-1:~<span class="comment"># sysctl -p /etc/sysctl.d/docker.conf </span></span><br><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line"></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br></pre></td></tr></table></figure><h3 id="æ‰€æœ‰èŠ‚ç‚¹ä¸Šå®‰è£…-Docker"><a href="#æ‰€æœ‰èŠ‚ç‚¹ä¸Šå®‰è£…-Docker" class="headerlink" title="æ‰€æœ‰èŠ‚ç‚¹ä¸Šå®‰è£… Docker"></a>æ‰€æœ‰èŠ‚ç‚¹ä¸Šå®‰è£… Docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[student@utility ~]$ ssh root@cka-1</span><br><span class="line"></span><br><span class="line">root@cka-1:~<span class="comment"># apt update</span></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">åœ¨Ubuntué‡ŒdockeråŒ…åå­—æ˜¯docker.io</span><br><span class="line">root@cka-1:~<span class="comment"># apt list | grep docker </span></span><br><span class="line">...</span><br><span class="line">docker.io/focal-updates 20.10.12-0ubuntu2~20.04.1 amd64</span><br><span class="line"></span><br><span class="line">k8sé›†ç¾¤ä¸‰å°æœºå™¨éƒ½å®‰è£…docker.io</span><br><span class="line">root@cka-1:~<span class="comment"># apt install -y docker.io</span></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹dockerç‰ˆæœ¬</span><br><span class="line">root@cka-1:~<span class="comment"># docker --version</span></span><br><span class="line">Docker version 20.10.12, build 20.10.12-0ubuntu2~20.04.1</span><br><span class="line"></span><br><span class="line">å¯åŠ¨dockeræœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯</span><br><span class="line">root@cka-1:~<span class="comment"># systemctl start docker &amp; systemctl enable docker</span></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">å›ºå®šdockerç‰ˆæœ¬,é¿å…è‡ªåŠ¨å‡çº§å¯¼è‡´ç‰ˆæœ¬ä¸å…¼å®¹</span><br><span class="line">root@cka-1:~<span class="comment"># apt-mark hold docker.io</span></span><br><span class="line">docker.io <span class="built_in">set</span> on hold.</span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br></pre></td></tr></table></figure><blockquote><p><font color="red">æ‰©å±•ï¼Œå¦‚ä½•å®‰è£…æŒ‡å®šç‰ˆæœ¬ docker</font></p><p><strong>åœ¨ Ubuntu ä¸Šï¼Œæ‰¾åˆ° docker.io æä¾›çš„ç‰ˆæœ¬</strong></p><p>root@cka-1:# <code>apt-cache madison docker.io</code><br> docker.io | <strong>20.10.12-0ubuntu2~20.04.1</strong> | <a href="http://mirrors.aliyun.com/ubuntu">http://mirrors.aliyun.com/ubuntu</a> focal-updates/universe amd64 Packages<br> docker.io | <strong>20.10.7-0ubuntu5~20.04.2</strong> | <a href="http://mirrors.aliyun.com/ubuntu">http://mirrors.aliyun.com/ubuntu</a> focal-security/universe amd64 Packages<br>â€¦</p><p>æ¯”å¦‚æˆ‘éœ€è¦å®‰è£… <strong>20.10.7</strong> ç‰ˆæœ¬ï¼Œåªéœ€åœ¨åŒ…åé¢æŒ‡å®šç‰ˆæœ¬å³å¯ï¼›</p><p>root@cka-1:# <code>apt install -y docker.io=20.10.7-0ubuntu5~20.04.2</code></p><p>æœªæŒ‡å®šç‰ˆæœ¬åé»˜è®¤å®‰è£…çš„éƒ½æ˜¯æœ€æ–°çš„ç‰ˆæœ¬</p></blockquote><h3 id="é…ç½®-Docker-ä»“åº“åœ°å€ï¼šé˜¿é‡ŒåŠ é€Ÿ"><a href="#é…ç½®-Docker-ä»“åº“åœ°å€ï¼šé˜¿é‡ŒåŠ é€Ÿ" class="headerlink" title="é…ç½® Docker ä»“åº“åœ°å€ï¼šé˜¿é‡ŒåŠ é€Ÿ"></a>é…ç½® Docker ä»“åº“åœ°å€ï¼šé˜¿é‡ŒåŠ é€Ÿ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…¬æœ‰ä»“åº“: </span></span><br><span class="line">root@cka-1:~<span class="comment"># vim /etc/docker/daemon.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://i1pfdcu7.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">node1å’Œnode2åŒç†</span><br><span class="line">root@cka-1:~<span class="comment"># scp /etc/docker/daemon.json root@cka-2:/etc/docker/</span></span><br><span class="line">root@cka-1:~<span class="comment"># scp /etc/docker/daemon.json root@cka-3:/etc/docker/</span></span><br><span class="line"></span><br><span class="line">é‡å¯dockeræœåŠ¡</span><br><span class="line">root@cka-1:~<span class="comment"># systemctl daemon-reload </span></span><br><span class="line">root@cka-1:~<span class="comment"># systemctl restart docker</span></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">æ£€æŸ¥é•œåƒåŠ é€Ÿæ˜¯å¦ç”Ÿæ•ˆ</span><br><span class="line">root@cka-1:~<span class="comment"># docker info</span></span><br><span class="line">...</span><br><span class="line"> Registry Mirrors:</span><br><span class="line">  https://i1pfdcu7.mirror.aliyuncs.com/ğŸ‘ˆ</span><br><span class="line"> Live Restore Enabled: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">æ‹‰å–é•œåƒ(é€šè¿‡é˜¿é‡ŒCDNåŠ é€Ÿä¸‹è½½)</span><br><span class="line">root@cka-1:~<span class="comment"># docker pull nginx</span></span><br><span class="line"></span><br><span class="line">root@cka-1:~<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">nginx        latest    605c77e624dd   10 months ago   141MB</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…å’Œéƒ¨ç½²-Kubernetes-é›†ç¾¤"><a href="#å®‰è£…å’Œéƒ¨ç½²-Kubernetes-é›†ç¾¤" class="headerlink" title="å®‰è£…å’Œéƒ¨ç½² Kubernetes é›†ç¾¤"></a>å®‰è£…å’Œéƒ¨ç½² Kubernetes é›†ç¾¤</h2><blockquote><p><strong>Kubeadm</strong> æ–¹å¼éƒ¨ç½²ï¼ˆè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œä»¥ pod æ–¹å¼è¿è¡Œæ ¸å¿ƒç»„ä»¶ ï¼‰ï¼Œ<strong>äºŒè¿›åˆ¶éƒ¨ç½²</strong>æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬é‡ç‚¹æ˜¯å¦‚ä½•ä½¿ç”¨ k8s é›†ç¾¤</p></blockquote><p>æ–‡ä»¶çš„æºè·¯å¾„æ˜¯åœ¨ä¸ªäººæœåŠ¡å™¨ä¸Šï¼ŒæºæœåŠ¡å™¨åœ°å€å¦‚ä¸‹ï¼Œä¸ç¡®å®šæœåŠ¡å™¨çš„å…³é—­æ—¶é—´ï¼Œæˆ‘ä»¬æå‰ä¸‹è½½åˆ°æœ¬åœ°ï¼›</p><p>k8s-master.tar  <a href="https://cka-2022-10-22-1252503622.cos.ap-guangzhou.myqcloud.com/k8s-master.tar">https://cka-2022-10-22-1252503622.cos.ap-guangzhou.myqcloud.com/k8s-master.tar</a></p><p>k8s-node.tar  <a href="https://cka-2022-10-22-1252503622.cos.ap-guangzhou.myqcloud.com/k8s-node.tar">https://cka-2022-10-22-1252503622.cos.ap-guangzhou.myqcloud.com/k8s-node.tar</a></p><p>calico.tar   <a href="https://cka-2022-10-22-1252503622.cos.ap-guangzhou.myqcloud.com/calico.tar">https://cka-2022-10-22-1252503622.cos.ap-guangzhou.myqcloud.com/calico.tar</a> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å°†<span class="string">&#x27;k8s-master.tarã€calico.tar&#x27;</span>æ–‡ä»¶ä¸Šä¼ åˆ°master</span><br><span class="line">F:\CKA\CKA-2022å®éªŒç¯å¢ƒ\files&gt;scp k8s-master.tar calico.tar student@192.168.19.101:/home/student</span><br><span class="line"></span><br><span class="line">å°†<span class="string">&#x27;k8s-node.tarã€calico.tar&#x27;</span>æ–‡ä»¶ä¸Šä¼ åˆ°node1å’Œnode2</span><br><span class="line">F:\CKA\CKA-2022å®éªŒç¯å¢ƒ\files&gt;scp k8s-node.tar calico.tar student@192.168.19.102:/home/student</span><br><span class="line">F:\CKA\CKA-2022å®éªŒç¯å¢ƒ\files&gt;scp k8s-node.tar calico.tar student@192.168.19.103:/home/student</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…-k8s-é›†ç¾¤"><a href="#å®‰è£…-k8s-é›†ç¾¤" class="headerlink" title="å®‰è£… k8s é›†ç¾¤"></a>å®‰è£… k8s é›†ç¾¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">- å› ä¸ºè€ƒè¯•æ—¶åªæä¾›æ™®é€šç”¨æˆ·çš„è´¦å·,æ‰€ä»¥æˆ‘ä»¬ç»ƒä¹ æ—¶ä¸€èˆ¬ä¹Ÿä¸ç”¨root</span><br><span class="line">ä½¿ç”¨studentç”¨æˆ·ç™»å½•master,node1å’Œnode2</span><br><span class="line">[root@utility ~]<span class="comment"># ssh student@cka-1</span></span><br><span class="line"></span><br><span class="line">ä¸‰å°æœºå™¨åˆ†åˆ«å¯¼å…¥æœ¬åœ°é•œåƒ</span><br><span class="line">student@cka-1:~$ sudo docker load -i k8s-master.tar </span><br><span class="line">student@cka-1:~$ sudo docker load -i calico.tar</span><br><span class="line"></span><br><span class="line">student@cka-2:~$ sudo docker load -i k8s-node.tar </span><br><span class="line">student@cka-2:~$ sudo docker load -i calico.tar </span><br><span class="line"></span><br><span class="line">student@cka-3:~$ sudo docker load -i k8s-node.tar </span><br><span class="line">student@cka-3:~$ sudo docker load -i calico.tar </span><br><span class="line"></span><br><span class="line">æ·»åŠ æœåŠ¡ç®¡ç†é€‰é¡¹(å¦‚æœæ²¡æœ‰æ·»åŠ ,åœ¨åˆå§‹åŒ–masteræ—¶è¿æ¥ä¼šè¢«æ‹’ç»)</span><br><span class="line">student@cka-1:~$ sudo sed -i <span class="string">&quot;s#^ExecStart=/usr/bin/dockerd.*#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd#g&quot;</span> /usr/lib/systemd/system/docker.service</span><br><span class="line"></span><br><span class="line">student@cka-1:~$ sudo systemctl daemon-reload </span><br><span class="line">student@cka-1:~$ sudo systemctl restart docker</span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">student@cka-1:~$ sudo <span class="built_in">cat</span> /usr/lib/systemd/system/docker.service</span><br><span class="line">...</span><br><span class="line">[Service]</span><br><span class="line">Type=notify</span><br><span class="line"><span class="comment"># the default is not to use systemd for cgroups because the delegate issues still</span></span><br><span class="line"><span class="comment"># exists and systemd currently does not support the cgroup feature set required</span></span><br><span class="line"><span class="comment"># for containers run by docker</span></span><br><span class="line">ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemdğŸ‘ˆ</span><br><span class="line">ExecReload=/bin/kill -s HUP <span class="variable">$MAINPID</span></span><br><span class="line">TimeoutSec=0</span><br><span class="line">RestartSec=2</span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ·»åŠ é˜¿é‡Œkubernetesçš„key</span><br><span class="line">student@cka-1:~$ sudo curl -s https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | sudo apt-key add -</span><br><span class="line">OK</span><br><span class="line"><span class="string">&#x27;curl -s å‚æ•°å°†ä¸è¾“å‡ºé”™è¯¯å’Œè¿›åº¦ä¿¡æ¯;ä¸Šé¢å‘½ä»¤ä¸€æ—¦å‘ç”Ÿé”™è¯¯,ä¸ä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯,ä¼šæ­£å¸¸æ˜¾ç¤ºè¿è¡Œç»“æœ&#x27;</span></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ·»åŠ é˜¿é‡Œkuberneteræº</span><br><span class="line">student@cka-1:~$ sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/kubernetes.list &lt;&lt;<span class="string">EOF </span></span><br><span class="line"><span class="string">&gt; deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main</span></span><br><span class="line"><span class="string">&gt; EOF</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ç”Ÿæˆçš„drop-inæ–‡ä»¶</span><br><span class="line">student@cka-1:~$ sudo <span class="built_in">cat</span> /etc/apt/sources.list.d/kubernetes.list</span><br><span class="line">deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main</span><br><span class="line"><span class="string">&#x27;æ„æ€æ˜¯ä¸‹è½½kubernetesæ—¶åœ¨é˜¿é‡Œçš„é•œåƒç«™&#x27;</span></span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">æ›´æ–°æœ¬åœ°ç¼“å­˜(åŒæ­¥é˜¿é‡Œçš„kubernetesä»“åº“)</span><br><span class="line">student@cka-1:~$ sudo apt update</span><br><span class="line">...</span><br><span class="line">79 packages can be upgraded. Run <span class="string">&#x27;apt list --upgradable&#x27;</span> to see them.</span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢å¯ä»¥éƒ¨ç½²çš„kubeadmç‰ˆæœ¬</span><br><span class="line">student@cka-1:~$ sudo apt-cache madison kubeadm </span><br><span class="line">   kubeadm |  1.25.4-00 | https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 Packages</span><br><span class="line">...</span><br><span class="line">   kubeadm |  1.23.0-00 | https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 Packages</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">- k8sé›†ç¾¤å®‰è£…kubeadm,kubelet,kubectl <span class="comment"># éƒ¨ç½²1.23.0-00ç‰ˆæœ¬,ä¸‰ä¸ªè½¯ä»¶åŒ…ç‰ˆæœ¬è¦ä¸€è‡´</span></span><br><span class="line">student@cka-1:~$ sudo apt install -y kubeadm=1.23.0-00 kubelet=1.23.0-00 kubectl=1.23.0-00</span><br><span class="line"></span><br><span class="line"><span class="comment">###å¦‚æœå‡ºç°ä»¥ä¸‹æŠ¥é”™,åˆ é™¤/var/lib/dpkg/lock-frontend.æ–‡ä»¶ä¹Ÿä¸è¡Œçš„è¯,åªèƒ½é‡å¯è§£å†³###</span></span><br><span class="line">Waiting <span class="keyword">for</span> cache lock: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 38Waiting <span class="keyword">for</span> cache lock: Could not get lock /var/lib/dpkg/lock-frontend. It is held by process</span><br><span class="line"></span><br><span class="line">å›ºå®škubeadmã€kubeletã€kubectlçš„ç‰ˆæœ¬</span><br><span class="line">student@cka-1:~$ sudo apt-mark hold kubeadm kubelet kubectl</span><br><span class="line">kubeadm <span class="built_in">set</span> on hold.</span><br><span class="line">kubelet <span class="built_in">set</span> on hold.</span><br><span class="line">kubectl <span class="built_in">set</span> on hold.</span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br><span class="line"></span><br><span class="line">åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šé…ç½®kubeletå¼€æœºè‡ªå¯ã€ä½†ä¸è¦å¯åŠ¨kubeletæœåŠ¡ã€‘</span><br><span class="line">student@cka-1:~$ sudo systemctl <span class="built_in">enable</span> kubelet</span><br><span class="line">&gt; node1 å’Œ node2 åŒç†</span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²-k8s-é›†ç¾¤"><a href="#éƒ¨ç½²-k8s-é›†ç¾¤" class="headerlink" title="éƒ¨ç½² k8s é›†ç¾¤"></a>éƒ¨ç½² k8s é›†ç¾¤</h3><blockquote><p>å• master èŠ‚ç‚¹éƒ¨ç½²</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- åˆå§‹åŒ–master,æŒ‡å®šk8sç‰ˆæœ¬<span class="string">&#x27;1.23.0&#x27;</span>,è®¾ç½®æ§åˆ¶å¹³é¢èŠ‚ç‚¹(master)IPåœ°å€<span class="string">&#x27;192.168.19.101&#x27;</span>,é•œåƒä»“åº“åœ°å€<span class="string">&#x27;registry.aliyuncs.com/google_containers&#x27;</span>,svcçš„ç½‘ç»œVIP<span class="string">&#x27;10.1.0.0/16&#x27;</span>,podçš„ç½‘æ®µ<span class="string">&#x27;10.244.0.0/16&#x27;</span></span><br><span class="line">student@cka-1:~$ sudo kubeadm init --kubernetes-version=1.23.0 --apiserver-advertise-address=192.168.19.101 --image-repository registry.aliyuncs.com/google_containers --service-cidr=10.1.0.0/16 --pod-network-cidr=10.244.0.0/16</span><br><span class="line">...</span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br><span class="line"></span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">  sudo <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">  sudo <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line">Alternatively, <span class="keyword">if</span> you are the root user, you can run:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br><span class="line"></span><br><span class="line">é…ç½®<span class="string">&#x27;student&#x27;</span>ç”¨æˆ·ä¸ºk8sç®¡ç†å‘˜: kubeconfigè®¤è¯</span><br><span class="line">student@cka-1:~$ sudo <span class="built_in">mkdir</span> ~/.kube</span><br><span class="line">student@cka-1:~$ sudo <span class="built_in">cp</span> /etc/kubernetes/admin.conf ~/.kube/config</span><br><span class="line">student@cka-1:~$ sudo <span class="built_in">chown</span> student:student ~/.kube/config</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹èŠ‚ç‚¹</span><br><span class="line">student@cka-1:~$ kubectl get nodes</span><br><span class="line">NAME                STATUS     ROLES                  AGE   VERSION</span><br><span class="line">cka-1.example.com   NotReady   control-plane,master   40m   v1.23.0</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###å¦‚æœåˆå§‹åŒ–masteræŠ¥é”™,æ˜¯å› ä¸ºæ²¡æœ‰æ·»åŠ æœåŠ¡ç®¡ç†é€‰é¡¹###</span></span><br><span class="line">...</span><br><span class="line">[etcd] Creating static Pod manifest <span class="keyword">for</span> <span class="built_in">local</span> etcd <span class="keyword">in</span> <span class="string">&quot;/etc/kubernetes/manifests&quot;</span></span><br><span class="line">[wait-control-plane] Waiting <span class="keyword">for</span> the kubelet to boot up the control plane as static Pods from directory <span class="string">&quot;/etc/kubernetes/manifests&quot;</span>. This can take up to 4m0s</span><br><span class="line">[kubelet-check] Initial <span class="built_in">timeout</span> of 40s passed.</span><br><span class="line">[kubelet-check] It seems like the kubelet isn<span class="string">&#x27;t running or healthy.</span></span><br><span class="line"><span class="string">[kubelet-check] The HTTP call equal to &#x27;</span>curl -sSL http://localhost:10248/healthz<span class="string">&#x27; failed with error: Get &quot;http://localhost:10248/healthz&quot;: dial tcp [::1]:10248: connect: connection refused.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è§£å†³ğŸ‘‡</span></span><br><span class="line"><span class="string">root@cka-1:~# kubeadm reset</span></span><br><span class="line"><span class="string">root@cka-1:~# reboot</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ·»åŠ æœåŠ¡ç®¡ç†é€‰é¡¹</span></span><br><span class="line"><span class="string">root@cka-1:~# sed -i &quot;s#^ExecStart=/usr/bin/dockerd.*#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd#g&quot; /usr/lib/systemd/system/docker.service</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å†è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="string">student@cka-1:~$ sudo kubeadm init</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²å®¢æˆ·ç«¯"><a href="#éƒ¨ç½²å®¢æˆ·ç«¯" class="headerlink" title="éƒ¨ç½²å®¢æˆ·ç«¯"></a>éƒ¨ç½²å®¢æˆ·ç«¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- é…ç½®utilityä¸ºkuberneteså®¢æˆ·ç«¯</span><br><span class="line">studentç”¨æˆ·ç™»å½•åˆ°utility,é…ç½®kubernetesçš„ä»“åº“</span><br><span class="line">[student@utility ~]$ sudo -i</span><br><span class="line">[root@utility ~]<span class="comment"># cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt;EOF </span></span><br><span class="line">&gt; [kubernetes]</span><br><span class="line">&gt; name=Kubernetes</span><br><span class="line">&gt; baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/</span><br><span class="line">&gt; enabled=1</span><br><span class="line">&gt; gpgcheck=0</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢kubectlå®¢æˆ·ç«¯çš„ç‰ˆæœ¬,éœ€è¦ä¸é›†ç¾¤çš„ç‰ˆæœ¬ä¸€è‡´(1.23.0)</span><br><span class="line">[root@utility ~]<span class="comment"># yum list --showduplicates kubeadm --disableexcludes=kubernetes | grep 1.23.0</span></span><br><span class="line">kubeadm.x86_64                       1.23.0-0                         kubernetes</span><br><span class="line">[root@utility ~]<span class="comment"># yum -y install kubectl-1.23.0-0</span></span><br><span class="line"></span><br><span class="line">æ­¤æ—¶utilityè¿˜ä¸èƒ½ç®¡ç†k8sé›†ç¾¤,å› ä¸ºé»˜è®¤æ˜¯è¿æ¥åˆ°äº†æœ¬åœ°çš„8080ç«¯å£</span><br><span class="line">[root@utility ~]<span class="comment"># kubectl get nodes</span></span><br><span class="line">The connection to the server localhost:8080 was refused - did you specify the right host or port?</span><br><span class="line"></span><br><span class="line">è®¾ç½®studentå¯ä»¥ç®¡ç†k8sé›†ç¾¤</span><br><span class="line">[student@utility ~]$ <span class="built_in">mkdir</span> ~/.kube</span><br><span class="line">[student@utility ~]$ scp student@cka-1:~/.kube/config .kube/</span><br><span class="line">[student@utility ~]$ <span class="built_in">chmod</span> 0600 .kube/config </span><br><span class="line"></span><br><span class="line">æ­¤æ—¶å¯ä»¥ç®¡ç†èŠ‚ç‚¹äº†</span><br><span class="line">[student@utility ~]$ kubectl get nodes</span><br><span class="line">NAME                STATUS     ROLES                  AGE   VERSION</span><br><span class="line">cka-1.example.com   NotReady   control-plane,master   71m   v1.23.0</span><br></pre></td></tr></table></figure><blockquote><p>ç»“è®ºï¼šåªè¦ä½ æœºå™¨ä¸Šçš„ç”¨æˆ·å®¶ç›®å½•ä¸‹æœ‰ ~/.kube/config æ–‡ä»¶ï¼Œå°±å¯ä»¥ç®¡ç†k8sé›†ç¾¤äº†ï¼›</p><p>å…¶ä¸­ config æ–‡ä»¶æ˜¯ä» /etc/kubernetes/admin.conf æ‹·è´çš„</p></blockquote><h3 id="æ·»åŠ -node-èŠ‚ç‚¹"><a href="#æ·»åŠ -node-èŠ‚ç‚¹" class="headerlink" title="æ·»åŠ  node èŠ‚ç‚¹"></a>æ·»åŠ  node èŠ‚ç‚¹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- åœ¨masterèŠ‚ç‚¹ä¸Šè·å–token</span><br><span class="line">student@cka-1:~$ sudo -i</span><br><span class="line">root@cka-1:~<span class="comment"># kubeadm token create --print-join-command</span></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.19.101:6443 --token v1tyj2.krhxy0ekjxavlhes --discovery-token-ca-cert-hash sha256:19d6ec1a75bbf962e808fbd64adb4e141d1ec4c95a6b05303f70c8dafbcfc079</span><br><span class="line"></span><br><span class="line">- åœ¨node1å’Œnode2ä¸Šå°†ä¸Šè¯‰å‘½ä»¤ç»“æœå¤åˆ¶æ‰“å°å³å¯</span><br><span class="line">æ·»åŠ cka-2ä½œä¸ºk8sçš„workerèŠ‚ç‚¹</span><br><span class="line">student@cka-2:~$ sudo kubeadm <span class="built_in">join</span> 192.168.19.101:6443 --token v1tyj2.krhxy0ekjxavlhes --discovery-token-ca-cert-hash sha256:19d6ec1a75bbf962e808fbd64adb4e141d1ec4c95a6b05303f70c8dafbcfc079</span><br><span class="line"></span><br><span class="line">æ·»åŠ cka-3ä½œä¸ºk8sçš„workerèŠ‚ç‚¹</span><br><span class="line">student@cka-3:~$ sudo kubeadm <span class="built_in">join</span> 192.168.19.101:6443 --token v1tyj2.krhxy0ekjxavlhes --discovery-token-ca-cert-hash sha256:19d6ec1a75bbf962e808fbd64adb4e141d1ec4c95a6b05303f70c8dafbcfc079</span><br><span class="line"></span><br><span class="line">å›åˆ°masterèŠ‚ç‚¹ä¸ŠæŸ¥çœ‹nodeçŠ¶æ€</span><br><span class="line">student@cka-1:~$ kubectl get nodes</span><br><span class="line">NAME                STATUS     ROLES                  AGE     VERSION</span><br><span class="line">cka-1.example.com   NotReady   control-plane,master   85m     v1.23.0</span><br><span class="line">cka-2.example.com   NotReady   &lt;none&gt;                 6m20s   v1.23.0</span><br><span class="line">cka-3.example.com   NotReady   &lt;none&gt;                 3m14s   v1.23.0</span><br><span class="line"><span class="comment"># æ­¤æ—¶çŠ¶æ€NotReadyæ˜¯å› ä¸ºæ²¡æœ‰é…ç½®ç½‘ç»œç»„ä»¶,ç½‘ç»œä¸é€š</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°masterèŠ‚ç‚¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F:\CKA\CKA-2022å®éªŒç¯å¢ƒ\files&gt;scp calico.yaml student@192.168.19.101:~</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">åœ¨masterèŠ‚ç‚¹ä¸Šé€šè¿‡<span class="string">&#x27;calico.yaml&#x27;</span>æ–‡ä»¶éƒ¨ç½²ç½‘ç»œç»„ä»¶</span><br><span class="line">student@cka-1:~$ kubectl create -f calico.yaml </span><br><span class="line"></span><br><span class="line">å†æ¬¡æŸ¥çœ‹nodeçš„çŠ¶æ€</span><br><span class="line">student@cka-1:~$ kubectl get nodes</span><br><span class="line">NAME                STATUS   ROLES                  AGE    VERSION</span><br><span class="line">cka-1.example.com   Ready    control-plane,master   120m   v1.23.0<span class="comment"># k8sç®¡ç†èŠ‚ç‚¹</span></span><br><span class="line">cka-2.example.com   Ready    &lt;none&gt;                 41m    v1.23.0<span class="comment"># k8s workerèŠ‚ç‚¹,è¿è¡Œç”Ÿäº§pod</span></span><br><span class="line">cka-3.example.com   Ready    &lt;none&gt;                 38m    v1.23.0<span class="comment"># k8s workerèŠ‚ç‚¹,è¿è¡Œç”Ÿäº§pod</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶nodesçš„çŠ¶æ€éƒ½æ˜¯Readyäº†</span></span><br><span class="line"></span><br><span class="line">æŸ¥<span class="string">&#x27;kube-system&#x27;</span>å‘½åç©ºé—´çš„é›†ç¾¤pods</span><br><span class="line">student@cka-1:~$ kubectl get pods -n kube-system</span><br><span class="line">NAME                                        READY   STATUS    RESTARTS   AGE</span><br><span class="line">calico-kube-controllers-68bbcc9985-gmlvq    1/1     Running   0          3m28s</span><br><span class="line">calico-node-hwtf4                           1/1     Running   0          3m28s</span><br><span class="line">calico-node-pnp2t                           1/1     Running   0          3m28s</span><br><span class="line">calico-node-sqj6j                           1/1     Running   0          3m28s</span><br><span class="line">coredns-6d8c4cb4d-8slt7                     1/1     Running   0          122m</span><br><span class="line">coredns-6d8c4cb4d-gk4s2                     1/1     Running   0          122m</span><br><span class="line">etcd-cka-1.example.com                      1/1     Running   0          122m</span><br><span class="line">kube-apiserver-cka-1.example.com            1/1     Running   0          122m</span><br><span class="line">kube-controller-manager-cka-1.example.com   1/1     Running   0          122m</span><br><span class="line">kube-proxy-dspvc                            1/1     Running   0          43m</span><br><span class="line">kube-proxy-t5dfl                            1/1     Running   0          40m</span><br><span class="line">kube-proxy-trrjp                            1/1     Running   0          122m</span><br><span class="line">kube-scheduler-cka-1.example.com            1/1     Running   0          122m</span><br><span class="line">student@cka-1:~$ </span><br></pre></td></tr></table></figure><h3 id="é…ç½®-kubectl-å‘½ä»¤è¡¥å…¨"><a href="#é…ç½®-kubectl-å‘½ä»¤è¡¥å…¨" class="headerlink" title="é…ç½® kubectl å‘½ä»¤è¡¥å…¨"></a>é…ç½® kubectl å‘½ä»¤è¡¥å…¨</h3><p><strong><font color="red">æç¤ºï¼šCKA è€ƒç‚¹</font></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">student@cka-1:~$ sudo apt install bash-completion</span><br><span class="line"></span><br><span class="line">ç¯å¢ƒå˜é‡ä¸´æ—¶ç”Ÿæ•ˆ</span><br><span class="line">student@cka-1:~$ <span class="built_in">source</span> &lt;(kubectl completion bash)</span><br><span class="line"></span><br><span class="line"><span class="comment">###å¼€æœºç”Ÿæ•ˆ###</span></span><br><span class="line">student@cka-1:~$ vim ~/.bashrc</span><br><span class="line">student@cka-1:~$ <span class="built_in">tail</span> ~/.bashrc</span><br><span class="line"><span class="comment"># sources /etc/bash.bashrc).</span></span><br><span class="line"><span class="keyword">if</span> ! <span class="built_in">shopt</span> -oq posix; <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">if</span> [ -f /usr/share/bash-completion/bash_completion ]; <span class="keyword">then</span></span><br><span class="line">    . /usr/share/bash-completion/bash_completion</span><br><span class="line">  <span class="keyword">elif</span> [ -f /etc/bash_completion ]; <span class="keyword">then</span></span><br><span class="line">    . /etc/bash_completion</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> &lt;(kubectl completion bash)ğŸ‘ˆ å°†å‘½ä»¤å†™åˆ°æœ€åä¸€è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="comment">###è€ƒè¯•æ—¶ä¸è¦å†™å‘½ä»¤åˆ°.bashrcæ–‡ä»¶###</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Kubernetes-é›†ç¾¤éƒ¨ç½²&quot;&gt;&lt;a href=&quot;#Kubernetes-é›†ç¾¤éƒ¨ç½²&quot; class=&quot;headerlink&quot; title=&quot;Kubernetes é›†ç¾¤éƒ¨ç½²&quot;&gt;&lt;/a&gt;Kubernetes é›†ç¾¤éƒ¨ç½²&lt;/h1&gt;&lt;h2 id=&quot;ç¯å¢ƒä»‹ç»&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒä»‹ç»&quot;&gt;&lt;/a&gt;ç¯å¢ƒä»‹ç»&lt;/h2&gt;&lt;p&gt;4 å°è™šæ‹Ÿæœºï¼Œ1 å° masterï¼Œ2 å° nodeï¼Œ1 å° utility æ˜¯è´Ÿè´£æä¾›ç½‘å…³å’Œé›†ç¾¤å†…éƒ¨é€šä¿¡&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;masterï¼š&lt;/strong&gt;192.168.19.101/24        ä¸»æœºåï¼šcka-1&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;node1ï¼š&lt;/strong&gt;  192.168.19.102/24        ä¸»æœºåï¼šcka-2    &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;node2ï¼š&lt;/strong&gt;  192.168.19.103/24        ä¸»æœºåï¼šcka-3&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;utilityï¼š&lt;/strong&gt;  10.0.0.133/24ï¼ˆNAT ç½‘å…³ï¼Œè¿é€šå¤–ç½‘ï¼‰ï¼›192.168.19.254/24ï¼ˆå®ç°é›†ç¾¤é—´é€šä¿¡ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;utility ç³»ç»Ÿæ˜¯ &lt;strong&gt;CentOS 7&lt;/strong&gt;ï¼Œk8s é›†ç¾¤ç³»ç»Ÿæ˜¯ &lt;strong&gt;Ubuntu&lt;/strong&gt; 20.04.2 LTS&lt;/p&gt;
&lt;p&gt;utility æ˜¯ä½œä¸ºå®¢æˆ·ç«¯è¿œç¨‹åˆ° k8s é›†ç¾¤çš„è·³æ¿æœºå’Œå……å½“ç½‘å…³åŠŸèƒ½ï¼›åŒç½‘å¡èƒ½è®© k8s é›†ç¾¤ä¹‹é—´äº’ç›¸é€šä¿¡ï¼Œä¹Ÿèƒ½å®ç°é›†ç¾¤è¿é€šå¤–ç½‘&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;a href=&quot;#å‡†å¤‡å·¥ä½œ&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;/a&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt;</summary>
    
    
    
    <category term="äº‘åŸç”Ÿ" scheme="https://laijune.github.io/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
    
    
    <category term="Kubernetes" scheme="https://laijune.github.io/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>Zabbix ç›‘æ§</title>
    <link href="https://laijune.github.io/2022/11/11/zabbix/"/>
    <id>https://laijune.github.io/2022/11/11/zabbix/</id>
    <published>2022-11-11T12:00:01.000Z</published>
    <updated>2022-11-16T15:29:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æ¥éƒ¨ç½² Zabbix æ¥ç›‘æ§æˆ‘çš„æœåŠ¡å™¨ï¼›</p><blockquote><p>Zabbix å®˜ç½‘æ‰‹å†Œï¼š<a href="https://www.zabbix.com/cn/manuals">https://www.zabbix.com/cn/manuals</a> ï¼›å…¶ä¸­ LTSï¼ˆLong Term Supportï¼‰æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚</p><p>æˆ‘ä»¬çš„æœåŠ¡å™¨ç¯å¢ƒä¾æ—§æ˜¯ <strong>CentOS Stream 8</strong>ï¼Œå®‰è£… Zabbix çš„ç‰ˆæœ¬æ˜¯ <strong>4.0 LTS</strong></p></blockquote><h2 id="å®‰è£…-zabbix-4-0-ç‰ˆæœ¬"><a href="#å®‰è£…-zabbix-4-0-ç‰ˆæœ¬" class="headerlink" title="å®‰è£… zabbix 4.0 ç‰ˆæœ¬"></a>å®‰è£… zabbix 4.0 ç‰ˆæœ¬</h2><h3 id="æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹"><a href="#æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹" class="headerlink" title="æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹"></a>æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹</h3><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">1.å®‰è£…zabbix.repoä»“åº“æ–‡ä»¶,æ¸…åæºçš„zabbix4ç‰ˆæœ¬(å¦‚æœæ˜¯å…¶å®ƒæ“ä½œç³»ç»Ÿ,åˆ™é€‰æ‹©å¯¹åº”ç‰ˆæœ¬çš„rpmåŒ…)</span><br><span class="line">[root@stream8 ~]<span class="comment"># rpm -ivh https://mirrors.tuna.tsinghua.edu.cn/zabbix/zabbix/4.0/rhel/8/x86_64/zabbix-release-4.0-2.el8.noarch.rpm</span></span><br><span class="line"></span><br><span class="line">æ­¤æ—¶,yumä»“åº“ä¼šå¤šä¸€ä¸ªzabbix.repoæ–‡ä»¶</span><br><span class="line">[root@stream8 ~]<span class="comment"># cat /etc/yum.repos.d/zabbix.repo </span></span><br><span class="line">[zabbix]</span><br><span class="line">name=Zabbix Official Repository - <span class="variable">$basearch</span></span><br><span class="line">baseurl=http://repo.zabbix.com/zabbix/4.0/rhel/8/<span class="variable">$basearch</span>/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX-A14FE591</span><br><span class="line"></span><br><span class="line">[zabbix-non-supported]</span><br><span class="line">name=Zabbix Official Repository non-supported - <span class="variable">$basearch</span></span><br><span class="line">baseurl=http://repo.zabbix.com/non-supported/rhel/8/<span class="variable">$basearch</span>/</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-ZABBIX</span><br><span class="line">gpgcheck=1</span><br><span class="line"></span><br><span class="line">æ›¿æ¢zabbixçš„æ¥æºè·¯å¾„ä¸ºæ¸…åçš„æº(å› ä¸ºzabbixå®˜ç½‘çš„æœåŠ¡å™¨åœ¨å›½å¤–)</span><br><span class="line">[root@stream8 ~]<span class="comment"># sed -i &#x27;s#repo.zabbix.com#mirrors.tuna.tsinghua.edu.cn/zabbix#g&#x27; /etc/yum.repos.d/zabbix.repo</span></span><br><span class="line"></span><br><span class="line">2.å®‰è£…zabbixæœåŠ¡ç«¯(å‰ç«¯)ã€zabbixè¿æ¥æ•°æ®åº“ã€zabbix-agent(å®¢æˆ·ç«¯)</span><br><span class="line">[root@stream8 ~]<span class="comment"># dnf -y install zabbix-server-mysql zabbix-web-mysql zabbix-agent mariadb-server</span></span><br><span class="line"><span class="comment"># zabbix 4.0é»˜è®¤æ˜¯lamp,æ‰€ä»¥è¿™ä¸€æ­¥ä¼šè‡ªåŠ¨å®‰è£…httpd,åœ¨5.0ç‰ˆæœ¬åˆ™ä¸ä¼šå®‰è£…httpd</span></span><br><span class="line"></span><br><span class="line">å¯åŠ¨mariadbæ•°æ®åº“,è®¾ç½®å¼€æœºè‡ªå¯</span><br><span class="line">[root@stream8 ~]<span class="comment"># systemctl start mariadb &amp; systemctl enable mariadb</span></span><br><span class="line"></span><br><span class="line">3.è®¾ç½®mariadbæ•°æ®åº“å¯†ç (é»˜è®¤è´¦å·æ˜¯root),åˆ›å»ºzabbixåº“(è®¾ç½®å­—ç¬¦é›†æ˜¯utf8),å­˜å‚¨ç›‘æ§æ•°æ®,ä¸”åˆ›å»ºè´¦å·</span><br><span class="line">[root@stream8 ~]<span class="comment"># mysqladmin password redhat</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># mysql -uroot -predhat -e &quot;create database zabbix character set utf8 collate utf8_bin;&quot;</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># mysql -uroot -predhat -e &quot;grant all privileges on zabbix.* to zabbix@localhost identified by &#x27;redhat&#x27;;&quot;</span></span><br><span class="line"></span><br><span class="line">æµ‹è¯•zabbixç”¨æˆ·</span><br><span class="line">[root@stream8 ~]<span class="comment"># mysql -uroot -predhat -e &quot;show databases;&quot;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| zabbix             |</span><br><span class="line">+--------------------+</span><br><span class="line"></span><br><span class="line">4.å¯¼å…¥zabbixçš„æ•°æ®åº“</span><br><span class="line">è¿™é‡Œå› ä¸ºStream8ç‰ˆæœ¬åŸå› ,zcatè¯»å–create.sql.gzä¼šæŠ¥é”™<span class="string">&quot;å¯¼å…¥çš„æ•°æ®è¡Œå¤ªé•¿äº†&quot;</span>,ä¿®æ”¹ä¸€ä¸‹mysqlçš„é…ç½®æ–‡ä»¶å¹¶é‡å¯æœåŠ¡å³å¯è§£å†³;</span><br><span class="line">[root@stream8 ~]<span class="comment"># vim /etc/my.cnf</span></span><br><span class="line">...æ·»åŠ ä¸‹å‡ è¡Œ</span><br><span class="line">[mysqld]</span><br><span class="line">innodb_strict_mode = 0</span><br><span class="line"></span><br><span class="line">[root@stream8 ~]<span class="comment"># systemctl restart mariadb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨CentOS 7ç‰ˆæœ¬åˆ™ä¸ä¼šå‡ºç°ä»¥ä¸Šé—®é¢˜</span></span><br><span class="line"><span class="comment"># ç”¨zcatç›´æ¥è¯»å–gzå‹ç¼©åŒ…,ç®¡é“ç¬¦äº¤ç»™mysqlå‘½ä»¤å¯¼å…¥æ•°æ®,å¾€zabbixåº“ä¸­å¯¼å…¥æ•°æ®</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -uroot -predhat zabbix</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å¯¼å…¥zabbixæ•°æ®åº“çš„è¡¨;</span><br><span class="line">[root@stream8 ~]<span class="comment"># mysql -uroot -predhat -e &quot;show tables from zabbix;&quot;</span></span><br><span class="line">...</span><br><span class="line">| <span class="built_in">users</span>                      |</span><br><span class="line">| users_groups               |</span><br><span class="line">| usrgrp                     |</span><br><span class="line">| valuemaps                  |</span><br><span class="line">| widget                     |</span><br><span class="line">| widget_field               |</span><br><span class="line">+----------------------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5. ç¼–è¾‘zabbix-serveræœåŠ¡ç«¯é…ç½®æ–‡ä»¶(ä¿®æ”¹æ•°æ®åº“éƒ¨åˆ†å³å¯)</span><br><span class="line">[root@stream8 ~]<span class="comment"># vim /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">...</span><br><span class="line"><span class="comment"># DBHost=localhostæ•°æ®åº“ä¸»æœº,é»˜è®¤æœªå¼€å¯</span></span><br><span class="line">DBHost=localhostå¯åŠ¨,æŒ‡å®šä¸ºæœ¬æœº</span><br><span class="line"></span><br><span class="line"><span class="comment"># DBPassword=æ•°æ®åº“å¯†ç ,é»˜è®¤æœªå¼€å¯</span></span><br><span class="line">DBPassword=redhatå¼€å¯,è®¾ç½®zabbixæ•°æ®åº“å¯†ç </span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å®Œ,ä¹Ÿå¯ä»¥ç›´æ¥æ›¿æ¢æºæ–‡ä»¶ä¸ºä»¥ä¸‹æœ‰æ•ˆçš„å†…å®¹,ç›´è§‚æ˜äº†</span><br><span class="line">[root@stream8 ~]<span class="comment"># grep &quot;^[a-Z]&quot; /etc/zabbix/zabbix_server.conf</span></span><br><span class="line">LogFile=/var/log/zabbix/zabbix_server.log</span><br><span class="line">LogFileSize=0</span><br><span class="line">PidFile=/var/run/zabbix/zabbix_server.pid</span><br><span class="line">SocketDir=/var/run/zabbix</span><br><span class="line">DBHost=localhost<span class="comment"># æŒ‡å®šmysqlçš„åœ°å€</span></span><br><span class="line">DBName=zabbix<span class="comment"># æ•°æ®åº“åå­—</span></span><br><span class="line">DBUser=zabbix<span class="comment"># æ•°æ®åº“çš„è¿æ¥ç”¨æˆ·</span></span><br><span class="line">DBPassword=redhat<span class="comment"># æ•°æ®åº“å¯†ç </span></span><br><span class="line">SNMPTrapperFile=/var/log/snmptrap/snmptrap.log<span class="comment"># å­˜æ”¾è‡ªå®šä¹‰ç›‘æ§é¡¹çš„ç›®å½•</span></span><br><span class="line">Timeout=4</span><br><span class="line">AlertScriptsPath=/usr/lib/zabbix/alertscripts</span><br><span class="line">ExternalScripts=/usr/lib/zabbix/externalscripts</span><br><span class="line">LogSlowQueries=3000</span><br><span class="line"></span><br><span class="line">6.å¯åŠ¨zabbixæœåŠ¡,ä¸”å¼€æœºè‡ªå¯</span><br><span class="line">[root@stream8 ~]<span class="comment"># systemctl start zabbix-server &amp; systemctl enable zabbix-server</span></span><br><span class="line"></span><br><span class="line">7.æ£€æŸ¥zabbix(zabbixæœåŠ¡ç«¯çš„ç«¯å£<span class="string">&#x27;10051&#x27;</span>)</span><br><span class="line">[root@stream8 ~]<span class="comment"># netstat -nltp</span></span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1131/sshd           </span><br><span class="line">tcp        0      0 0.0.0.0:10051           0.0.0.0:*               LISTEN      13601/zabbix_server </span><br><span class="line">tcp6       0      0 :::3306                 :::*                    LISTEN      9999/mysqld         </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      1131/sshd           </span><br><span class="line">tcp6       0      0 :::10051                :::*                    LISTEN      13601/zabbix_server </span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>è‡³æ­¤ï¼Œzabbix-server æœåŠ¡ç«¯æ ¸å¿ƒç¨‹åºå°±è£…å¥½äº†ï¼Œä»¥åŠ zabbix-UI è¿™ä¸ªphpç¨‹åºä¹Ÿè£…å¥½äº†ï¼›</p><p>è¿˜éœ€é…ç½® web å‰ç«¯ï¼Œé»˜è®¤ zabbix 4.0 ç‰ˆæœ¬åªæ”¯æŒ apacheï¼Œä¸åŒ zabbix ç‰ˆæœ¬ web å‰ç«¯ä»£ç†ä¸ä¸€æ ·ï¼ˆnginxã€apacheï¼‰</p></blockquote><p><strong>Apache é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">1.ä¿®æ”¹PHPæ—¶åŒº</span><br><span class="line">[root@stream8 ~]<span class="comment"># vim /etc/php.ini </span></span><br><span class="line">...</span><br><span class="line">;date.timezone =<span class="comment"># æ‰¾åˆ°æ—¶åŒºè¿™ä¸€è¡Œ(é»˜è®¤æ˜¯æœªå¼€å¯çš„)</span></span><br><span class="line">date.timezone = Asia/Shanghai<span class="comment"># è®¾ç½®ä¸ºäºšæ´²/ä¸Šæµ·</span></span><br><span class="line"></span><br><span class="line">å¦‚æœåç»­æ‰‹åŠ¨ä¿®æ”¹äº†æ—¶åŒº,éœ€è¦é‡å¯phpçš„æœåŠ¡</span><br><span class="line">[root@stream8 ~]<span class="comment"># systemctl restart php-fpm</span></span><br><span class="line"></span><br><span class="line">2.é‡å¯apacheæœåŠ¡</span><br><span class="line"><span class="comment"># æŸ¥çœ‹apacheå­ç›®å½•zabbixçš„é…ç½®</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># cat /etc/httpd/conf.d/zabbix.conf </span></span><br><span class="line">...</span><br><span class="line">Alias /zabbix /usr/share/zabbix å¯ä»¥çœ‹åˆ°è®¿é—®/zabbix,ä¼šè½¬å‘åˆ°/usr/share/zabbixç›®å½•</span><br><span class="line"></span><br><span class="line">&lt;Directory <span class="string">&quot;/usr/share/zabbix&quot;</span>&gt;</span><br><span class="line">    Options FollowSymLinks</span><br><span class="line">    AllowOverride None</span><br><span class="line">    Require all granted</span><br><span class="line"></span><br><span class="line">    &lt;FilesMatch \.(php|phar)$&gt;</span><br><span class="line">        SetHandler <span class="string">&quot;proxy:unix:/run/php-fpm/zabbix.sock|fcgi://localhost&quot;</span></span><br><span class="line">    &lt;/FilesMatch&gt;</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[root@stream8 ~]<span class="comment"># systemctl start httpd &amp; systemctl enable httpd</span></span><br></pre></td></tr></table></figure><p><strong>è®¿é—®æœåŠ¡å™¨çš„<code>IP</code>åŠ <code>/zabbix</code></strong></p><img src="/2022/11/11/zabbix/image-20221111230949455.png" alt="image-20221111230949455" style="zoom:150%;"><img src="/2022/11/11/zabbix/image-20221111231310604.png" alt="image-20221111231310604" style="zoom:150%;"><img src="/2022/11/11/zabbix/image-20221111231714873.png" alt="image-20221111231714873" style="zoom:150%;"><img src="/2022/11/11/zabbix/image-20221111231948330.png" alt="image-20221111231948330" style="zoom:150%;"><p><img src="/2022/11/11/zabbix/image-20221111232031222.png" alt="image-20221111232031222"></p><p><img src="/2022/11/11/zabbix/image-20221111232105026.png" alt="image-20221111232105026"></p><img src="/2022/11/11/zabbix/image-20221111232259952.png" alt="image-20221111232259952" style="zoom:150%;"><blockquote><p>åé¢ä¼šæ•™å¤§å®¶ï¼Œå¦‚ä½•åœ¨åç«¯ä¿®æ”¹ Zabbix çš„ Admin ç”¨æˆ·çš„å¯†ç </p></blockquote><img src="/2022/11/11/zabbix/image-20221111232456595.png" alt="image-20221111232456595" style="zoom:150%;"><img src="/2022/11/11/zabbix/image-20221111232832617.png" alt="image-20221111232832617" style="zoom:150%;"><blockquote><p>å¦‚æœ web ç•Œé¢ä¸èƒ½é€‰æ‹©ä½¿ç”¨ä¸­æ–‡ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å®‰è£…ä¸­æ–‡è¯­è¨€åŒ…</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…zh_CNè¯­è¨€åŒ…</span><br><span class="line">[root@stream8 ~]<span class="comment"># dnf install langpacks-zh_CN.noarch -y</span></span><br><span class="line"></span><br><span class="line">ç„¶ååˆ·æ–°webç•Œé¢,å°±èƒ½é€‰æ‹©ä¸­æ–‡äº†</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹å›¾å½¢çš„æ•°æ®å±•ç¤ºï¼ˆé»˜è®¤å­—ä½“æœ‰é—®é¢˜ï¼‰</strong></p><img src="/2022/11/11/zabbix/image-20221111234231331.png" alt="image-20221111234231331" style="zoom:150%;"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½å­—ä½“,ä¿®æ”¹zabbixçš„å­—ä½“æ”¯æŒ(å› ä¸ºç¼ºå°‘zabbixæ‰€éœ€çš„å­—ä½“)</span><br><span class="line"><span class="comment"># æ–‡æ³‰ä»ªå¾®å­—ä½“</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># yum install wqy-microhei-fonts -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹·è´ä¸‹è½½çš„å­—ä½“è¦†ç›–zabbixçš„å›¾å½¢å­—ä½“</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># cp /usr/share/fonts/wqy-microhei/wqy-microhei.ttc /usr/share/zabbix/assets/fonts/graphfont.ttf </span></span><br><span class="line"><span class="built_in">cp</span>: overwrite <span class="string">&#x27;/usr/share/zabbix/assets/fonts/graphfont.ttf&#x27;</span>? y</span><br></pre></td></tr></table></figure><p>åˆ·æ–° web ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°ä¹±ç çš„ä¸­æ–‡å­—ä½“ç”Ÿæ•ˆäº†</p><img src="/2022/11/11/zabbix/image-20221111234958289.png" alt="image-20221111234958289" style="zoom:150%;"><h3 id="ä¿®æ”¹-Zabbix-é»˜è®¤-Admin-ç”¨æˆ·çš„å¯†ç "><a href="#ä¿®æ”¹-Zabbix-é»˜è®¤-Admin-ç”¨æˆ·çš„å¯†ç " class="headerlink" title="ä¿®æ”¹ Zabbix é»˜è®¤ Admin ç”¨æˆ·çš„å¯†ç "></a>ä¿®æ”¹ Zabbix é»˜è®¤ Admin ç”¨æˆ·çš„å¯†ç </h3><blockquote><p>zabbixéƒ¨ç½²åï¼Œä½¿ç”¨é»˜è®¤çš„ Admin è´¦æˆ·ç™»å½•ï¼Œå¯†ç é»˜è®¤æ˜¯ zabbixï¼›</p></blockquote><p><strong>æ•°æ®åº“é‡ç½® zabbix webç”¨æˆ·</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆ,è¿›å…¥zabbixæ•°æ®åº“,æŸ¥çœ‹å½“å‰<span class="built_in">users</span>è¡¨çš„ä¿¡æ¯</span><br><span class="line">[root@stream8 ~]<span class="comment"># mysql -uroot -predhat </span></span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection <span class="built_in">id</span> is 385</span><br><span class="line">Server version: 10.3.28-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use zabbix;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [zabbix]&gt; select * from <span class="built_in">users</span>;</span><br><span class="line">+--------+-------+--------+---------------+----------------------------------+-----+-----------+------------+-------+---------+------+---------+----------------+---------------+---------------+---------------+</span><br><span class="line">| userid | <span class="built_in">alias</span> | name   | surname       | passwd                           | url | autologin | autologout | lang  | refresh | <span class="built_in">type</span> | theme   | attempt_failed | attempt_ip    | attempt_clock | rows_per_page |</span><br><span class="line">+--------+-------+--------+---------------+----------------------------------+-----+-----------+------------+-------+---------+------+---------+----------------+---------------+---------------+---------------+</span><br><span class="line">|      1 | Admin | Zabbix | Administrator | 5fce1b3e34b520afeffb37ce08c7cd66 |     |         1 | 0          | zh_CN | 30s     |    3 | default |              0 | 27.38.213.189 |    1668181951 |            50 |</span><br><span class="line">|      2 | guest |        |               | d41d8cd98f00b204e9800998ecf8427e |     |         0 | 15m        | en_GB | 30s     |    1 | default |              0 |               |             0 |            50 |</span><br><span class="line">+--------+-------+--------+---------------+----------------------------------+-----+-----------+------------+-------+---------+------+---------+----------------+---------------+---------------+---------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°ç”¨æˆ·è¡¨ä¸­çš„ç”¨æˆ·Adminçš„å¯†ç æ˜¯é€šè¿‡MD5åŠ å¯†çš„</span></span><br></pre></td></tr></table></figure><p><a href="https://www.cmd5.com/">ã€MD5 åœ¨çº¿åŠ å¯†åŠè§£å¯†ã€‘</a></p><p>é€šè¿‡ MD5 åè§£ Admin ç”¨æˆ·çš„æ•°æ®åº“å¯†ç </p><p><img src="/2022/11/11/zabbix/image-20221112000032655.png" alt="image-20221112000032655"></p><blockquote><p>è¿™é‡Œå­¦ä¹ ä¸€ä¸‹åœ¨ Linux ä¸­ç”Ÿæˆ MD5 å€¼</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯ä»¥ä½¿ç”¨å‘½ä»¤ç”Ÿæˆmd5å€¼(å¦‚ä¸‹,ç”Ÿæˆæ˜æ–‡genmd5çš„md5å€¼)</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># echo -n genmd5 | openssl md5</span></span><br><span class="line">(stdin)= caf22338e37c42b2f2e9358ba6bedb04</span><br></pre></td></tr></table></figure><p><strong>æ‰‹åŠ¨æ›´æ–° zabbix Admin ç”¨æˆ·çš„å¯†ç </strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">è®¾ç½®md5çš„å¯†ç ä¸º<span class="string">&#x27;Aa123!&#x27;</span></span><br><span class="line">[root@stream8 ~]<span class="comment"># echo -n Aa123! | openssl md5</span></span><br><span class="line">(stdin)= 675278e2a74b19cfa0a5f766424c67cc</span><br><span class="line"></span><br><span class="line">[root@stream8 ~]<span class="comment"># mysql -uroot -predhat</span></span><br><span class="line">MariaDB [(none)]&gt; use zabbix;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°zabbix webç”¨æˆ·ç™»å½•å¯†ç </span></span><br><span class="line">MariaDB [zabbix]&gt; update <span class="built_in">users</span> <span class="built_in">set</span> passwd=<span class="string">&#x27;675278e2a74b19cfa0a5f766424c67cc&#x27;</span> <span class="built_in">where</span> userid = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.003 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">MariaDB [zabbix]&gt; select * from <span class="built_in">users</span>;</span><br><span class="line">+--------+-------+--------+---------------+----------------------------------+-----+-----------+------------+-------+---------+------+---------+----------------+---------------+---------------+---------------+</span><br><span class="line">| userid | <span class="built_in">alias</span> | name   | surname       | passwd                           | url | autologin | autologout | lang  | refresh | <span class="built_in">type</span> | theme   | attempt_failed | attempt_ip    | attempt_clock | rows_per_page |</span><br><span class="line">+--------+-------+--------+---------------+----------------------------------+-----+-----------+------------+-------+---------+------+---------+----------------+---------------+---------------+---------------+</span><br><span class="line">|      1 | Admin | Zabbix | Administrator | 675278e2a74b19cfa0a5f766424c67cc |     |         1 | 0          | zh_CN | 30s     |    3 | default |              0 | 27.38.213.189 |    1668181951 |            50 |</span><br><span class="line">|      2 | guest |        |               | d41d8cd98f00b204e9800998ecf8427e |     |         0 | 15m        | en_GB | 30s     |    1 | default |              0 |               |             0 |            50 |</span><br><span class="line">+--------+-------+--------+---------------+----------------------------------+-----+-----------+------------+-------+---------+------+---------+----------------+---------------+---------------+---------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">MariaDB [zabbix]&gt; FLUSH PRIVILEGES;</span><br><span class="line">Query OK, 0 rows affected (0.000 sec)</span><br></pre></td></tr></table></figure><p><strong>ç™»å½•æµ‹è¯• ï¼</strong></p><img src="/2022/11/11/zabbix/image-20221112001106389.png" alt="image-20221112001106389" style="zoom:200%;"><img src="/2022/11/11/zabbix/image-20221112001119489.png" alt="image-20221112001119489" style="zoom:150%;"><h2 id="å®‰è£…-zabbix-5-0-ç‰ˆæœ¬"><a href="#å®‰è£…-zabbix-5-0-ç‰ˆæœ¬" class="headerlink" title="å®‰è£… zabbix 5.0 ç‰ˆæœ¬"></a>å®‰è£… zabbix 5.0 ç‰ˆæœ¬</h2><p>5.0 ç‰ˆæœ¬å¯¹åŸºç¡€ç¯å¢ƒçš„è¦æ±‚æœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œæœ€å¤§çš„å°±æ˜¯å¯¹ php ç‰ˆæœ¬çš„è¦æ±‚ï¼Œæœ€ä½è¦æ±‚ 7.2.0 ç‰ˆæœ¬ï¼Œå¯¹ php æ‰©å±•ç»„ä»¶ä¹Ÿæœ‰è¦æ±‚ï¼›</p><p>è¯¦è§å®˜ç½‘ï¼š<a href="https://www.zabbix.com/documentation/5.0/zh/manual/installation/requirements">https://www.zabbix.com/documentation/5.0/zh/manual/installation/requirements</a></p><p><strong>ç¯å¢ƒä»‹ç»</strong></p><p>1 å° serverï¼Œ2 å° agentï¼Œç³»ç»Ÿæ˜¯ CentOS Stream 8</p><p><strong>serverï¼š</strong> 10.0.0.10/24</p><p><strong>agent1ï¼š</strong>10.0.0.11/24</p><p><strong>agent2ï¼š</strong>10.0.0.12/24</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.ç¯å¢ƒå‡†å¤‡</span><br><span class="line">å…³é—­é˜²ç«å¢™(ä¸‰å°æœºå™¨)</span><br><span class="line">[root@server ~]<span class="comment"># sed -i &#x27;s/SELINUX=enforcing/SELINUX=disabled/&#x27; /etc/selinux/config</span></span><br><span class="line">[root@server ~]<span class="comment"># systemctl disable --now firewalld</span></span><br><span class="line"></span><br><span class="line">æ­¤æ—¶è·å–å½“å‰selinuxé˜²ç«å¢™çš„å®‰å…¨ç­–ç•¥ä»ä¸ºEnforcing,é…ç½®æ–‡ä»¶å¹¶æœªç”Ÿæ•ˆ</span><br><span class="line">[root@server ~]<span class="comment"># reboot</span></span><br><span class="line"></span><br><span class="line">è·å–zabbixçš„ä¸‹è½½æº</span><br><span class="line">[root@server ~]<span class="comment"># rpm -Uvh https://mirrors.aliyun.com/zabbix/zabbix/5.0/rhel/8/x86_64/zabbix-release-5.0-1.el8.noarch.rpm</span></span><br><span class="line"></span><br><span class="line">æ›´æ¢zabbix.repoæº</span><br><span class="line">[root@server ~]<span class="comment"># sed -i &#x27;s#http://repo.zabbix.com#https://mirrors.aliyun.com/zabbix#&#x27; /etc/yum.repos.d/zabbix.repo</span></span><br><span class="line"></span><br><span class="line">2.å®‰è£…zabbix serverå’Œagent</span><br><span class="line">[root@server ~]<span class="comment"># dnf -y install zabbix-server-mysql zabbix-agent</span></span><br><span class="line"></span><br><span class="line">3.å®‰è£…zabbixå‰ç«¯ç¯å¢ƒ</span><br><span class="line">[root@server ~]<span class="comment"># dnf -y install zabbix-web-mysql zabbix-apache-conf</span></span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæ˜¯ CentOS 7 ç‰ˆæœ¬ï¼Œåˆ™éœ€è¦å®‰è£… Software Collectionsï¼Œä¾¿äºåç»­å®‰è£…é«˜ç‰ˆæœ¬çš„ phpï¼Œé»˜è®¤ yum å®‰è£…çš„ php ç‰ˆæœ¬ä¸º 5.4 è¿‡ä½ã€‚SCLï¼ˆSoftware Collectionsï¼‰å¯ä»¥è®©ä½ åœ¨åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸Šå®‰è£…å’Œä½¿ç”¨å¤šä¸ªç‰ˆæœ¬çš„è½¯ä»¶ï¼Œè€Œä¸ä¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„è½¯ä»¶åŒ…ã€‚</p><p>ä¸ºäº†é¿å…ç³»ç»Ÿå¹¿æ³›å†²çªï¼ŒåŒ…å®‰è£…åœ¨ /opt/rh ç›®å½•ä¸­ï¼Œä¾‹å¦‚ï¼Œè¿™å…è®¸ä½ åœ¨ CentOS 7 æœºå™¨ä¸Šå®‰è£… Python3.5ï¼Œè€Œä¸ä¼šåˆ é™¤æˆ–å¹²æ‰° Python 2.7.</p><p><code>yum -y install centos-release-scl</code></p><p><strong>è¿™å°±æ˜¯ zabbix 5.0 å’Œ 4.0 çš„åŒºåˆ«ä¹‹ä¸€ï¼Œä¸è¿‡å› ä¸ºæˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯ CentOS Steam 8ï¼Œç›´æ¥å®‰è£… php åˆšå¥½å°±æ˜¯ 7.2 ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ğŸ¤£</strong></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">4.å®‰è£zabbixæ‰€éœ€çš„æ•°æ®åº“</span><br><span class="line">[root@server ~]<span class="comment"># dnf -y install mariadb-server</span></span><br><span class="line"></span><br><span class="line">5.é…ç½®æ•°æ®åº“</span><br><span class="line">[root@server ~]<span class="comment"># systemctl enable --now mariadb</span></span><br><span class="line"></span><br><span class="line">åˆå§‹åŒ–æ•°æ®åº“,è®¾ç½®å¯†ç </span><br><span class="line">[root@server ~]<span class="comment"># mysql_secure_installation </span></span><br><span class="line">...</span><br><span class="line">Enter current password <span class="keyword">for</span> root (enter <span class="keyword">for</span> none): ã€å›è½¦,é»˜è®¤æ˜¯ç©ºã€‘</span><br><span class="line">OK, successfully used password, moving on...</span><br><span class="line"></span><br><span class="line">Set root password? [Y/n] yã€è®¾ç½®rootå¯†ç ã€‘</span><br><span class="line">New password:  ã€redhatã€‘</span><br><span class="line">Re-enter new password: ã€redhatã€‘</span><br><span class="line">Password updated successfully!</span><br><span class="line"></span><br><span class="line">Remove anonymous <span class="built_in">users</span>? [Y/n] yã€Y,ç§»é™¤åŒ¿åç”¨æˆ·ã€‘</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">Disallow root login remotely? [Y/n] nã€n,ä¸ç¦æ­¢rootè¿œç¨‹ç™»å½•ã€‘</span><br><span class="line"> ... skipping.</span><br><span class="line"></span><br><span class="line">Remove <span class="built_in">test</span> database and access to it? [Y/n] yã€Y,åˆ é™¤<span class="built_in">test</span>æ•°æ®åº“ã€‘</span><br><span class="line"> - Dropping <span class="built_in">test</span> database...</span><br><span class="line"> ... Success!</span><br><span class="line"> - Removing privileges on <span class="built_in">test</span> database...</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">Reload privilege tables now? [Y/n] yã€Y,ç¡®è®¤åˆ·æ–°æˆæƒè¡¨ã€‘</span><br><span class="line"> ... Success!</span><br><span class="line"></span><br><span class="line">ç™»å½•æ•°æ®åº“</span><br><span class="line">[root@server ~]<span class="comment"># mysql -uroot -predhat</span></span><br><span class="line"></span><br><span class="line">åˆ›å»ºzabbixæ•°æ®åº“</span><br><span class="line">MariaDB [(none)]&gt; create database zabbix character <span class="built_in">set</span> utf8 collate utf8_bin;</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">æ·»åŠ æ•°æ®åº“ç”¨æˆ·,ä»¥åŠzabbixæ‰€éœ€çš„æ•°æ®åº“ä¿¡æ¯</span><br><span class="line">MariaDB [(none)]&gt; create user zabbix@localhost identified by <span class="string">&quot;redhat&quot;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; grant all privileges on zabbix.* to zabbix@localhost;</span><br><span class="line">Query OK, 0 rows affected (0.001 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; flush privileges;</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; <span class="built_in">exit</span></span><br><span class="line">Bye</span><br><span class="line"></span><br><span class="line">6.ä½¿ç”¨zabbix-mysqlå‘½ä»¤,å¯¼å…¥æ•°æ®åº“ä¿¡æ¯</span><br><span class="line">[root@server ~]<span class="comment"># zcat /usr/share/doc/zabbix-server-mysql/create.sql.gz | mysql -uzabbix -predhat zabbix</span></span><br><span class="line"></span><br><span class="line">[root@server ~]<span class="comment"># mysql -uroot -predhat -e &quot;show tables from zabbix;&quot;</span></span><br><span class="line">| <span class="built_in">users</span>                      |</span><br><span class="line">| users_groups               |</span><br><span class="line">| usrgrp                     |</span><br><span class="line">| valuemaps                  |</span><br><span class="line">| widget                     |</span><br><span class="line">| widget_field               |</span><br><span class="line">+----------------------------+</span><br><span class="line"></span><br><span class="line">7.ä¿®æ”¹zabbix serveré…ç½®æ–‡ä»¶,ä¿®æ”¹æ•°æ®åº“å¯†ç </span><br><span class="line">[root@server ~]<span class="comment"># vim /etc/zabbix/zabbix_server.conf </span></span><br><span class="line">...</span><br><span class="line"><span class="comment"># DBPassword=</span></span><br><span class="line">DBPassword=redhat<span class="comment"># æŒ‡å®šæ•°æ®åº“å¯†ç </span></span><br><span class="line"></span><br><span class="line">8.ä¿®æ”¹zabbixçš„phpé…ç½®æ–‡ä»¶</span><br><span class="line">[root@server ~]<span class="comment"># vim /etc/php-fpm.d/zabbix.conf </span></span><br><span class="line">; php_value[date.timezone] = Europe/Riga<span class="comment"># é»˜è®¤æ˜¯æ³¨é‡Šçš„&quot;;&quot;</span></span><br><span class="line">php_value[date.timezone] = Asia/Shanghai<span class="comment"># å°†æ—¶åŒºæ”¹æˆäºšæ´²/ä¸Šæµ·</span></span><br><span class="line"></span><br><span class="line">9.å¯åŠ¨zabbixæœåŠ¡</span><br><span class="line"><span class="comment"># zabbixå‰ç«¯è¯·æ±‚æ˜¯äº¤ç»™phpè§£æ</span></span><br><span class="line">[root@server ~]<span class="comment"># ls /etc/systemd/system | grep php</span></span><br><span class="line">php-fpm.service.d</span><br><span class="line">[root@server ~]<span class="comment"># systemctl start zabbix-server zabbix-agent httpd php-fpm </span></span><br><span class="line">[root@server ~]<span class="comment"># systemctl enable zabbix-server zabbix-agent httpd php-fpm</span></span><br><span class="line"></span><br><span class="line">10.è®¿é—®zabbixç•Œé¢,å’Œ4.0ä¸€è‡´,IP + /zabbix</span><br></pre></td></tr></table></figure><img src="/2022/11/11/zabbix/image-20221114141325025.png" alt="image-20221114141325025" style="zoom:150%;"><p>åç»­æ­¥éª¤å‚è€ƒ zabbix4.0</p><img src="/2022/11/11/zabbix/image-20221114141628067.png" alt="image-20221114141628067" style="zoom:150%;"><img src="/2022/11/11/zabbix/image-20221114141857519.png" alt="image-20221114141857519" style="zoom: 200%;">]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»Šå¤©æ¥éƒ¨ç½² Zabbix æ¥ç›‘æ§æˆ‘çš„æœåŠ¡å™¨ï¼›&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Zabbix å®˜ç½‘æ‰‹å†Œï¼š&lt;a href=&quot;https://www.zabbix.com/cn/manuals&quot;&gt;https://www.zabbix.com/cn/manuals&lt;/a&gt; ï¼›å…¶ä¸­ LTSï¼ˆLong Term Supportï¼‰æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æœåŠ¡å™¨ç¯å¢ƒä¾æ—§æ˜¯ &lt;strong&gt;CentOS Stream 8&lt;/strong&gt;ï¼Œå®‰è£… Zabbix çš„ç‰ˆæœ¬æ˜¯ &lt;strong&gt;4.0 LTS&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å®‰è£…-zabbix-4-0-ç‰ˆæœ¬&quot;&gt;&lt;a href=&quot;#å®‰è£…-zabbix-4-0-ç‰ˆæœ¬&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£… zabbix 4.0 ç‰ˆæœ¬&quot;&gt;&lt;/a&gt;å®‰è£… zabbix 4.0 ç‰ˆæœ¬&lt;/h2&gt;&lt;h3 id=&quot;æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹&quot;&gt;&lt;a href=&quot;#æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹&quot; class=&quot;headerlink&quot; title=&quot;æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹&quot;&gt;&lt;/a&gt;æœåŠ¡ç«¯éƒ¨ç½²æµç¨‹&lt;/h3&gt;</summary>
    
    
    
    <category term="ç›‘æ§" scheme="https://laijune.github.io/categories/%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="Zabbix" scheme="https://laijune.github.io/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>Linux è¿œç¨‹æ¡Œé¢ Windows</title>
    <link href="https://laijune.github.io/2022/10/14/Linux%20Remote%20Windows%20&amp;%20Linux/"/>
    <id>https://laijune.github.io/2022/10/14/Linux%20Remote%20Windows%20&amp;%20Linux/</id>
    <published>2022-10-14T12:00:00.000Z</published>
    <updated>2022-11-15T06:23:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><font color="red">ä¸Šä¸€ç« æˆ‘ä»¬å°è¯•äº† windows è¿œç¨‹è¿æ¥ Linux çš„æœºå™¨ï¼Œåªéœ€è¦åœ¨ Linux å®¢æˆ·ç«¯ä¸Šå®‰è£… xrdp å·¥å…·å¹¶å¼€å¯æœåŠ¡å³å¯ï¼Œè¿™æ¬¡æˆ‘ä»¬å°è¯• Linux è¿æ¥ Windowsï¼Œè¿˜æœ‰ Linux è¿æ¥ Linux . . .Â </font></p><p>Linux è¿œç¨‹è¿æ¥ Windows æœ‰ä¸¤ç§æ–¹æ³•ï¼Œrdesktop å’Œ freerdpï¼›</p><p>Ubuntu å®‰è£…è¿™ä¸¤ç§åŒ…å¾ˆæ–¹ä¾¿ï¼Œåªéœ€ apt install rdesktop æˆ– apt install freerdp å³å¯ï¼Œå› ä¸º Ubuntu æ˜¯åŸºäº Debain æ¶æ„çš„ï¼›</p><p>CentOS ç³»åˆ—å®‰è£…åˆ™è´¹åŠ²å¾ˆå¤šï¼Œå› ä¸ºéœ€è¦é¢å¤–å®‰è£…å…¶å®ƒçš„ä¾èµ–åŒ…</p><h2 id="å®‰è£…-rdesktop"><a href="#å®‰è£…-rdesktop" class="headerlink" title="å®‰è£… rdesktop"></a>å®‰è£… rdesktop</h2><blockquote><p><strong>rdesktop</strong> æ˜¯ä¸€ä¸ªç”¨äºè¿æ¥åˆ° Windows è¿œç¨‹æ¡Œé¢æœåŠ¡çš„å¼€æº UNIX å®¢æˆ·ç«¯ï¼Œèƒ½å¤ŸåŸç”Ÿä½¿ç”¨è¿œç¨‹æ¡Œé¢åè®® (RDP) æ¥å‘ˆç°ç”¨æˆ·çš„ Windows æ¡Œé¢ã€‚</p><p>rdesktop å·²çŸ¥å¯ä¸ Windows æœåŠ¡å™¨ç‰ˆæœ¬ï¼ˆä» NT 4 ç»ˆç«¯æœåŠ¡å™¨åˆ° Windows Server 2016ï¼‰ä¸€èµ·å·¥ä½œã€‚</p><p>æœ¬æ¬¡å®¢æˆ·ç«¯å®‰è£…çš„ç‰ˆæœ¬æ˜¯ CentOS Stream 9</p></blockquote><p><strong>å‡†å¤‡å·¥ä½œ</strong></p><ol><li>é…ç½®ç½‘ç»œï¼Œèƒ½è”é€šå¤–ç½‘</li></ol><ol start="2"><li>ä» github ä¸Šä¸‹è½½ rdesktop çš„å‹ç¼©åŒ…ï¼Œé“¾æ¥ <a href="https://github.com/rdesktop/rdesktop">https://github.com/rdesktop/rdesktop</a></li></ol><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># wget https://github.com/rdesktop/rdesktop/releases/download/v1.9.0/rdesktop-1.9.0.tar.gz</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># tar xf rdesktop-1.9.0.tar.gz </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cd rdesktop-1.9.0/</span></span><br><span class="line"></span><br><span class="line">- ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šå‡ºç°å„ç§æŠ¥é”™ï¼Œæ˜¯ç”±äºä¾èµ–çš„å®‰è£…åŒ…æœªå®‰è£…çš„åŸå› ï¼Œå®‰è£…å¯¹åº”çš„ä¾èµ–åŒ…å³å¯</span><br><span class="line">- å®‰è£…ç¼ºå°‘çš„ä¾èµ–åŒ…</span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install python3-pip</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install python-devel</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install libX11-devel </span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install gcc g++</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install krb5-devel</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install libtasn1-devel</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install libXcursor-devel</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install gnutls-devel</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># python3 -m pip install gssapi</span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># dnf -y install pcsc-lite</span></span><br><span class="line">...</span><br><span class="line">Installed:</span><br><span class="line">  pcsc-lite-1.9.4-1.el9.x86_64                    pcsc-lite-ccid-1.4.36-1.el9.x86_64                    pcsc-lite-libs-1.9.4-1.el9.x86_64    </span><br><span class="line">  </span><br><span class="line">- æ ¹æ®ç‰ˆæœ¬å·éœ€è¦å®‰è£…å¯¹åº”çš„ pcsc-lite-devel å®‰è£…åŒ… </span><br><span class="line">- åœ¨æ­¤é“¾æ¥ http://www.rpmfind.net/linux/rpm2html/search.php?query=pcsc-lite-devel</span><br><span class="line">- å®‰è£…åŒ…é€‰æ‹©: pcsc-lite-develSystem: centosArch: x86_64</span><br><span class="line">&gt; å› ä¸ºæˆ‘ä»¬å®‰è£…pcscçš„ç‰ˆæœ¬æ˜¯1.9.4ï¼Œæ‰€ä»¥é€‰æ‹©<span class="string">&#x27;pcsc-lite-devel-1.9.4-1.el9.x86_64.rpm&#x27;</span>ç‰ˆæœ¬,</span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># wget http://www.rpmfind.net/linux/centos-stream/9-stream/CRB/x86_64/os/Packages/pcsc-lite-devel-1.9.4-1.el9.x86_64.rpm</span></span><br><span class="line"></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># rpm -i pcsc-lite-devel-1.9.4-1.el9.x86_64.rpm </span></span><br><span class="line"><span class="comment"># å¦‚æœé€‰æ‹©çš„ç‰ˆæœ¬ä¸æ˜¯ä¸€æ ·çš„è¯,æ˜¯æ— æ³•å®‰è£…æˆåŠŸçš„</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–è¯‘ï¼Œå®‰è£…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- okay,å®‰è£…å®Œä¾èµ–åŒ…å,å†ä½¿ç”¨./configureè¿›è¡Œç¼–è¯‘å®‰è£…</span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># ./configure </span></span><br><span class="line">...</span><br><span class="line">configure: creating ./config.status</span><br><span class="line">config.status: creating MakefileğŸ‘ˆçœ‹åˆ°è¿™åˆ™è¯´æ˜ç¼–è¯‘æˆåŠŸäº†</span><br><span class="line"></span><br><span class="line">- æœ€åè¾“å…¥ä¸‹é¢å‘½ä»¤,å®Œæˆå®‰è£…</span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># make </span></span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># make install</span></span><br></pre></td></tr></table></figure><ul><li><strong><font color="blue">è¿æ¥ Windows</font></strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- ä½¿ç”¨ rdesktop è¿œç¨‹è¿æ¥</span><br><span class="line">[root@localhost rdesktop-1.9.0]<span class="comment"># rdesktop 192.168.0.193#å®¢æˆ·ç«¯IP,é»˜è®¤æ˜¯3389ç«¯å£</span></span><br><span class="line">...</span><br><span class="line">Do you trust this certificate (<span class="built_in">yes</span>/no)? ã€<span class="built_in">yes</span>ã€‘</span><br></pre></td></tr></table></figure><img src="/2022/10/14/Linux%20Remote%20Windows%20&%20Linux/image-20221011221251445.png" alt="image-20221011221251445" style="zoom:80%;"><ul><li><strong><font color="brown">è¿æ¥ Linux æœåŠ¡ç«¯</font></strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- å½“ç„¶,Linuxä¹‹é—´ä¹Ÿå¯ä»¥é€šè¿‡ rdesktop å®ç°<span class="comment"># å‰ææ˜¯æœåŠ¡ç«¯çš„Linuxé…ç½®å¥½äº†xrdpç­‰æœåŠ¡å¹¶å¯åŠ¨</span></span><br><span class="line">-gæŒ‡å®šå±å¹•åˆ†è¾¨ç‡</span><br><span class="line">-uæŒ‡å®šç”¨æˆ·å</span><br><span class="line">-p æŒ‡å®šå¯†ç </span><br><span class="line">[root@localhost ~]<span class="comment"># rdesktop -g 90% -u root 10.10.10.10# é»˜è®¤æ˜¯3389ç«¯å£</span></span><br></pre></td></tr></table></figure><img src="/2022/10/14/Linux%20Remote%20Windows%20&%20Linux/xrdp.gif" alt="xrdp" style="zoom:95%;"><h2 id="å®‰è£…-freerdp"><a href="#å®‰è£…-freerdp" class="headerlink" title="å®‰è£… freerdp"></a>å®‰è£… freerdp</h2><blockquote><p>FreeRDP æ˜¯ä¸€ä¸ª Remote Desktop Protocolï¼ˆåè®®ï¼‰çš„ä¸€ä¸ªå®ç°ï¼Œéµå¾ªApacheå¼€æºåè®®ï¼Œæ”¯æŒ3DåŠŸèƒ½ï¼Œå¹¶æœ‰è¾ƒé«˜åˆ·æ–°ç‡ï¼Œä¹Ÿæ”¯æŒRemoteFXï¼ŒH264ç¼–è§£ç ï¼Œç”¨æˆ·ç®¡ç†ï¼ŒéŸ³é¢‘ä»¥åŠå¤–è®¾é‡å®šå‘ç­‰åŠŸèƒ½ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- å®‰è£…freerdpè½¯ä»¶åŒ…</span><br><span class="line">[root@localhost ~]<span class="comment"># dnf -y install freerdp</span></span><br><span class="line"></span><br><span class="line">- ç„¶åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†,freerdp åœ¨ centos å’Œ ubuntu éƒ½å¯ä»¥ç›´æ¥å®‰è£…</span><br><span class="line">&gt; éäº¤äº’å¼</span><br><span class="line">[root@localhost ~]<span class="comment"># xfreerdp -u user -p passwd -v 192.168.0.193</span></span><br><span class="line"></span><br><span class="line">&gt; äº¤äº’å¼</span><br><span class="line">[root@localhost ~]<span class="comment"># xfreerdp -u user -v 192.168.0.193</span></span><br><span class="line">Password:ã€å¯†ç ã€‘</span><br><span class="line"></span><br><span class="line">-u æŒ‡å®šç”¨æˆ·å</span><br><span class="line">-pæŒ‡å®šå¯†ç </span><br><span class="line">-wwide å®½</span><br><span class="line">-hhigh é«˜</span><br><span class="line">-f full,å±å¹•å…¨å±,ä½†æ˜¯è¿™æ ·ä¸å¥½é€€å‡ºå“ˆå“ˆ,å±å æ¯”æ‹‰æ»¡ğŸ˜‚</span><br><span class="line">- [root@localhost ~]<span class="comment"># xfreerdp -u root -p redhat -w 1920 -h 1080 -v 10.10.10.10</span></span><br></pre></td></tr></table></figure><img src="/2022/10/14/Linux%20Remote%20Windows%20&%20Linux/freerdp.gif" alt="freerdp" style="zoom:95%;">]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ä¸Šä¸€ç« æˆ‘ä»¬å°è¯•äº† windows è¿œç¨‹è¿æ¥ Linux çš„æœºå™¨ï¼Œåªéœ€è¦åœ¨ Linux å®¢æˆ·ç«¯ä¸Šå®‰è£… xrdp å·¥å…·å¹¶å¼€å¯æœåŠ¡å³å¯ï¼Œè¿™æ¬¡æˆ‘ä»¬å°è¯• Linux è¿æ¥ Windowsï¼Œè¿˜æœ‰ Linux è¿æ¥ Linux . . .Â &lt;/font&gt;&lt;/p&gt;
&lt;p&gt;Linux è¿œç¨‹è¿æ¥ Windows æœ‰ä¸¤ç§æ–¹æ³•ï¼Œrdesktop å’Œ freerdpï¼›&lt;/p&gt;
&lt;p&gt;Ubuntu å®‰è£…è¿™ä¸¤ç§åŒ…å¾ˆæ–¹ä¾¿ï¼Œåªéœ€ apt install rdesktop æˆ– apt install freerdp å³å¯ï¼Œå› ä¸º Ubuntu æ˜¯åŸºäº Debain æ¶æ„çš„ï¼›&lt;/p&gt;
&lt;p&gt;CentOS ç³»åˆ—å®‰è£…åˆ™è´¹åŠ²å¾ˆå¤šï¼Œå› ä¸ºéœ€è¦é¢å¤–å®‰è£…å…¶å®ƒçš„ä¾èµ–åŒ…&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£…-rdesktop&quot;&gt;&lt;a href=&quot;#å®‰è£…-rdesktop&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£… rdesktop&quot;&gt;&lt;/a&gt;å®‰è£… rdesktop&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;rdesktop&lt;/strong&gt; æ˜¯ä¸€ä¸ªç”¨äºè¿æ¥åˆ° Windows è¿œç¨‹æ¡Œé¢æœåŠ¡çš„å¼€æº UNIX å®¢æˆ·ç«¯ï¼Œèƒ½å¤ŸåŸç”Ÿä½¿ç”¨è¿œç¨‹æ¡Œé¢åè®® (RDP) æ¥å‘ˆç°ç”¨æˆ·çš„ Windows æ¡Œé¢ã€‚&lt;/p&gt;
&lt;p&gt;rdesktop å·²çŸ¥å¯ä¸ Windows æœåŠ¡å™¨ç‰ˆæœ¬ï¼ˆä» NT 4 ç»ˆç«¯æœåŠ¡å™¨åˆ° Windows Server 2016ï¼‰ä¸€èµ·å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ¬¡å®¢æˆ·ç«¯å®‰è£…çš„ç‰ˆæœ¬æ˜¯ CentOS Stream 9&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‡†å¤‡å·¥ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é…ç½®ç½‘ç»œï¼Œèƒ½è”é€šå¤–ç½‘&lt;/li&gt;
&lt;/ol&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ä» github ä¸Šä¸‹è½½ rdesktop çš„å‹ç¼©åŒ…ï¼Œé“¾æ¥ &lt;a href=&quot;https://github.com/rdesktop/rdesktop&quot;&gt;https://github.com/rdesktop/rdesktop&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="RDP" scheme="https://laijune.github.io/categories/RDP/"/>
    
    
    <category term="rdesktop" scheme="https://laijune.github.io/tags/rdesktop/"/>
    
  </entry>
  
  <entry>
    <title>Windows è¿œç¨‹æ¡Œé¢ Linux</title>
    <link href="https://laijune.github.io/2022/10/07/Windows%20Remote%20Linux/"/>
    <id>https://laijune.github.io/2022/10/07/Windows%20Remote%20Linux/</id>
    <published>2022-10-07T02:00:00.000Z</published>
    <updated>2022-11-15T06:23:20.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ³¨æ„ï¼šRHEL9ç³»åˆ—ï¼ˆåŒ…æ‹¬rhelï¼‰çš„ç‰ˆæœ¬åœ¨å®‰è£…è½¯ä»¶æ—¶ä¼šå‡ºç°ä¸æˆåŠŸçš„æƒ…å†µï¼Œè¿™åº”è¯¥å’Œ rhel çš„é»˜è®¤æºå’Œè®¢é˜…æœ‰å…³ï¼›</p><p>åœ¨ CentOS å’Œ CentOS Stream ç³»åˆ—ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæœ€å°åŒ–å®‰è£…å’Œå›¾å½¢åŒ–å®‰è£…ï¼ˆGUIï¼‰éƒ½å¯ä»¥é…ç½®</p></blockquote><p><strong>æœ¬æ¬¡å®éªŒä½¿ç”¨çš„æ˜¯æœ€å°åŒ–å®‰è£…ï¼Œæ— å›¾å½¢ç•Œé¢</strong></p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ol><li>é…ç½®ç½‘ç»œï¼Œèƒ½ä¸Šå¤–ç½‘ </li></ol><ol start="2"><li>é…ç½® aliyun çš„ epel æºï¼Œé“¾æ¥ <a href="http://www.aliyun.com/">www.aliyun.com</a> ï¼Œæœç´¢ epel</li></ol><span id="more"></span><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; ä¸‹è½½æ–°repo åˆ°/etc/yum.repos.d/ã€ä¸‹é¢ä¾‹å­ä»¥CentOS Stream 9åšæ¼”ç¤ºã€‘</span><br><span class="line"></span><br><span class="line">- å®‰è£…epelé…ç½®åŒ…</span><br><span class="line">yum install -y https://mirrors.aliyun.com/epel/epel-release-latest-8.noarch.rpm</span><br><span class="line"><span class="comment">#æ³¨æ„: å¦‚æœæ˜¯centos 7,åˆ™ç›´æ¥å®‰è£…epel-releaseå°±å¯ä»¥å®‰è£…xrdpäº†,ä¸éœ€è¦æ›¿æ¢epelæº,å¦åˆ™ä¼šæç¤ºä½¿ç”¨yumå‘½ä»¤å¤±è´¥</span></span><br><span class="line"></span><br><span class="line">- å°†repoé…ç½®ä¸­çš„åœ°å€æ›¿æ¢ä¸ºé˜¿é‡Œäº‘é•œåƒç«™åœ°å€</span><br><span class="line">sed -i <span class="string">&#x27;s|^#baseurl=https://download.example/pub|baseurl=https://mirrors.aliyun.com|&#x27;</span> /etc/yum.repos.d/epel*</span><br><span class="line">sed -i <span class="string">&#x27;s|^metalink|#metalink|&#x27;</span> /etc/yum.repos.d/epel*</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…-xrdp-å’Œ-xorgxrdp"><a href="#å®‰è£…-xrdp-å’Œ-xorgxrdp" class="headerlink" title="å®‰è£… xrdp å’Œ xorgxrdp"></a>å®‰è£… xrdp å’Œ xorgxrdp</h2><blockquote><p><a href="http://www.xrdp.org/">Xrdp</a>æ˜¯ä¸€ä¸ªå¼€æºå·¥å…·ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ Windows <a href="https://so.csdn.net/so/search?q=RDP&spm=1001.2101.3001.7020">RDP</a> è®¿é—® Linux è¿œç¨‹æ¡Œé¢ã€‚é™¤äº† Windows RDPï¼Œxrdp å·¥å…·è¿˜æ¥å—æ¥è‡ªå…¶ä»– RDP å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¦‚ FreeRDPã€rdesktop å’Œ NeutrinoRDPã€‚Xrdp ç°åœ¨æ”¯æŒ <a href="https://github.com/neutrinolabs/xrdp/wiki/TLS-security-layer">TLS å®‰å…¨å±‚</a>ã€‚</p><p>xrdp åªæ˜¯ä¸€ä¸ªå£³ï¼Œæä¾›ä¸€ä¸ªè¿œç¨‹è¿æ¥çš„<strong>åŠ å¯†</strong>é€šé“ã€‚</p><p>Xorg æ˜¯å…±äº«æœºå™¨çš„èµ„æºã€‚æ¯æ¬¡è¿æ¥ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„sessionï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ¡Œé¢ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># dnf -y install xrdp xorgxrdp</span></span><br><span class="line"></span><br><span class="line">ä¿®æ”¹é…ç½®æ–‡ä»¶</span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/xrdp/xrdp.ini</span></span><br><span class="line">...</span><br><span class="line">[Globals]</span><br><span class="line">; xrdp.ini file version number</span><br><span class="line">ini_version=1</span><br><span class="line"></span><br><span class="line">; fork a new process <span class="keyword">for</span> each incoming connection</span><br><span class="line">fork=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">; ports to listen on, number alone means listen on all interfaces</span><br><span class="line">; 0.0.0.0 or :: <span class="keyword">if</span> ipv6 is configured</span><br><span class="line">; space between multiple occurrences</span><br><span class="line">; ALL specified interfaces must be UP when xrdp starts, otherwise xrdp will fail to start</span><br><span class="line">;</span><br><span class="line">; Examples:</span><br><span class="line">;   port=3389</span><br><span class="line">;   port=unix://./tmp/xrdp.socket</span><br><span class="line">;   port=tcp://.:3389                           127.0.0.1:3389</span><br><span class="line">;   port=tcp://:3389                            *:3389</span><br><span class="line">;   port=tcp://&lt;any ipv4 format addr&gt;:3389      192.168.1.1:3389</span><br><span class="line">;   port=tcp6://.:3389                          ::1:3389</span><br><span class="line">;   port=tcp6://:3389                           *:3389</span><br><span class="line">;   port=tcp6://&#123;&lt;any ipv6 format addr&gt;&#125;:3389   &#123;FC00:0:0:0:0:0:0:1&#125;:3389</span><br><span class="line">;   port=vsock://&lt;cid&gt;:&lt;port&gt;</span><br><span class="line">port=3389ğŸ‘ˆã€Globalã€‘ä¸‹çš„portæ˜¯è¿œç¨‹è¿æ¥æ¡Œé¢æ—¶å¼€æ”¾çš„ç«¯å£,windowsè¿œç¨‹è¿æ¥å¿…é¡»å¼€æ”¾3389</span><br><span class="line"></span><br><span class="line">[Xorg]ğŸ‘ˆã€xorgã€‘é»˜è®¤æ˜¯æ³¨é‡Š,ä¸å¯ç”¨çš„;å»æ‰<span class="string">&#x27;#&#x27;</span>,å¼€æ”¾Xorgä¼šè¯</span><br><span class="line">name=Xorg</span><br><span class="line">lib=libxup.so</span><br><span class="line">username=ask</span><br><span class="line">password=ask</span><br><span class="line">ip=127.0.0.1</span><br><span class="line">port=-1</span><br><span class="line">code=20</span><br><span class="line"></span><br><span class="line"><span class="comment">#[Xvnc]ğŸ‘ˆã€Xvncã€‘é»˜è®¤å¯ç”¨Xvncä¼šè¯,æ³¨é‡Š,ä¸å¯ç”¨. </span></span><br><span class="line"><span class="comment">#name=Xvnc</span></span><br><span class="line"><span class="comment">#lib=libvnc.so</span></span><br><span class="line"><span class="comment">#username=ask</span></span><br><span class="line"><span class="comment">#password=ask</span></span><br><span class="line"><span class="comment">#ip=127.0.0.1</span></span><br><span class="line"><span class="comment">#port=-1</span></span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œé€‰æ‹©ä½¿ç”¨ <strong>Xorg</strong> ä¼šè¯è€Œä¸æ˜¯ Xvncï¼ŒXvnc å¥½åƒè¦å’Œ tigerVNC é…åˆçš„ã€‚æˆ‘æ²¡è£… tigerVNC</p></blockquote><ul><li>å¼€æ”¾é˜²ç«å¢™æ‰€åœ¨åŒºåŸŸéœ€è¦è¿œç¨‹è¿å…¥ç«¯å£</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># firewall-cmd --get-default-zone</span></span><br><span class="line">public</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># firewall-cmd --zone=public --add-port=3389/tcp --permanent</span></span><br><span class="line">success</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># firewall-cmd --reload</span></span><br><span class="line">success</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦é…ç½®å…¬ç½‘IPè¿å…¥çš„ç«¯å£,åˆ™å¼€æ”¾å…¬ç½‘è¿æ¥çš„ç«¯å£å³å¯</span></span><br></pre></td></tr></table></figure><ul><li>é‡å¯ xrdp æœåŠ¡ï¼Œè¿œç¨‹æ¥å…¥</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># systemctl restart xrdp</span></span><br></pre></td></tr></table></figure><img src="/2022/10/07/Windows%20Remote%20Linux/image-20221009105031756.png" alt="image-20221009105031756" style="zoom:80%;"><img src="/2022/10/07/Windows%20Remote%20Linux/image-20221009105259323.png" alt="image-20221009105259323" style="zoom:80%;"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- æ·»åŠ ç”¨æˆ·,è®¾ç½®å¯†ç </span><br><span class="line">[root@localhost ~]<span class="comment"># for i in &#123;1..2&#125;; do useradd stu$i; done</span></span><br><span class="line">[root@localhost ~]<span class="comment"># for i in &#123;1..2&#125;; do echo redhat | passwd --stdin stu$i; done</span></span><br><span class="line">Changing password <span class="keyword">for</span> user stu1.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">Changing password <span class="keyword">for</span> user stu2.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure><ul><li><strong>æ­¤æ—¶è¿œç¨‹ç™»å½•ç”¨æˆ·æ˜¯ä¼šç›´æ¥é€€å‡ºä¼šè¯çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯æœ€å°åŒ–å®‰è£…ï¼Œè¿˜æ²¡æœ‰æ¡Œé¢ï¼Œæ— æ³•è¿›å…¥è¿œç¨‹ç•Œé¢</strong></li></ul><img src="/2022/10/07/Windows%20Remote%20Linux/stu1.gif" alt="stu1" style="zoom:80%;"><blockquote><p><strong>å¦‚æœæ˜¯å®‰è£…äº†å›¾å½¢åŒ–ç•Œé¢çš„CentOSï¼Œæ­¤æ—¶å°±å¯ä»¥ç›´æ¥è¿›å…¥è‡ªå¸¦çš„ GNOME æ¡Œé¢äº†</strong></p><p>GNOME æ˜¯ä¸€ä¸ªå®Œå…¨ç”±è‡ªç”±è½¯ä»¶ç»„æˆçš„æ¡Œé¢ç¯å¢ƒ</p></blockquote><img src="/2022/10/07/Windows%20Remote%20Linux/stu1-2.gif" alt="stu1-2" style="zoom:80%;"><p><strong><font color="purple">ä¸è¿‡é»˜è®¤å®‰è£…çš„GNOMEæ¡Œé¢ç¯å¢ƒï¼Œåœ¨èµ„æºè¦æ±‚è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œä¼šæ¯”è¾ƒå¡é¡¿ï¼Œè¿™æ—¶å¯ä»¥å®‰è£…openboxè½»é‡çº§çš„å›¾å½¢æ¡Œé¢</font></strong></p><h2 id="å®‰è£…-openbox"><a href="#å®‰è£…-openbox" class="headerlink" title="å®‰è£… openbox"></a>å®‰è£… openbox</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">- å®‰è£…openboxè½»å·§çª—å£ç®¡ç†å™¨(Openboxæ˜¯è¿è¡Œäºæ­è½½X11çš„GNU/Linuxä¸Šçš„è½»å·§çª—å£ç®¡ç†å™¨)</span><br><span class="line">[root@localhost ~]<span class="comment"># dnf -y install openbox</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- å°†é»˜è®¤openboxçš„é…ç½®æ–‡ä»¶åšå¤‡ä»½</span><br><span class="line">[root@localhost ~]<span class="comment"># mv /etc/X11/xinit/Xsession /etc/X11/xinit/Xsession.bak</span></span><br><span class="line"></span><br><span class="line">- é‡æ–°ç¼–å†™å¯åŠ¨ä¼šè¯æ–‡ä»¶</span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/X11/xinit/Xsession</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">exec</span> openbox-sessionğŸ‘ˆå¼€æœºæ‰§è¡ŒOpenboxæ¡Œé¢ä¼šè¯;ä¸€å®šè¦è¿™ä¹ˆè®¾ç½®,å¦åˆ™æ˜¯ä¸ä¼šè¿›å…¥openboxæ¡Œé¢</span><br><span class="line"></span><br><span class="line">- å¤‡ä»½openboxé»˜è®¤xmlæ–‡ä»¶</span><br><span class="line">[root@localhost ~]<span class="comment"># mv /etc/xdg/openbox/menu.xml /etc/xdg/openbox/menu.xml.bak</span></span><br><span class="line"></span><br><span class="line">- è‡ªå®šä¹‰xmlæ–‡ä»¶</span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/xdg/openbox/menu.xml</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line"></span><br><span class="line">&lt;openbox_menu xmlns=<span class="string">&quot;http://openbox.org/3.4/menu&quot;</span>&gt;</span><br><span class="line">&lt;menu <span class="built_in">id</span>=<span class="string">&quot;root-menu&quot;</span> label=<span class="string">&quot;Openbox 3&quot;</span>&gt;</span><br><span class="line">  &lt;separator label=<span class="string">&quot;Tools&quot;</span>/&gt;</span><br><span class="line">  &lt;item label=<span class="string">&quot;Terminal&quot;</span>&gt;</span><br><span class="line">    &lt;action name=<span class="string">&quot;Execute&quot;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">command</span>&gt;xfce4-terminal&lt;/command&gt;</span><br><span class="line">    &lt;/action&gt;</span><br><span class="line">  &lt;/item&gt;</span><br><span class="line">  &lt;item label=<span class="string">&quot;VNC Viewer&quot;</span>&gt;</span><br><span class="line">    &lt;action name=<span class="string">&quot;Execute&quot;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">command</span>&gt;vncviewer&lt;/command&gt;</span><br><span class="line">    &lt;/action&gt;</span><br><span class="line">  &lt;/item&gt;</span><br><span class="line">  &lt;separator label=<span class="string">&quot;Others&quot;</span>/&gt;</span><br><span class="line">  &lt;item label=<span class="string">&quot;Reconfigure&quot;</span>&gt;</span><br><span class="line">    &lt;action name=<span class="string">&quot;Reconfigure&quot;</span> /&gt;</span><br><span class="line">  &lt;/item&gt;</span><br><span class="line">  &lt;item label=<span class="string">&quot;Exit&quot;</span>&gt;</span><br><span class="line">    &lt;action name=<span class="string">&quot;Exit&quot;</span>&gt;</span><br><span class="line">      &lt;prompt&gt;<span class="built_in">yes</span>&lt;/prompt&gt;</span><br><span class="line">    &lt;/action&gt;</span><br><span class="line">  &lt;/item&gt;</span><br><span class="line">  &lt;separator/&gt;</span><br><span class="line">  &lt;item label=<span class="string">&quot;Log Out&quot;</span>&gt;</span><br><span class="line">    &lt;action name=<span class="string">&quot;SessionLogout&quot;</span>&gt;</span><br><span class="line">      &lt;prompt&gt;<span class="built_in">yes</span>&lt;/prompt&gt;</span><br><span class="line">    &lt;/action&gt;</span><br><span class="line">  &lt;/item&gt;</span><br><span class="line">&lt;/menu&gt;</span><br><span class="line"></span><br><span class="line">&lt;/openbox_menu&gt;</span><br><span class="line"></span><br><span class="line">- é‡å¯xrdpæœåŠ¡</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl restart xrdp</span></span><br></pre></td></tr></table></figure><p><strong>æ­¤æ—¶å¯ä»¥é¡ºåˆ©è¿›å…¥ç•Œé¢äº†ï¼Œä¸è¿‡è¿›å…¥åæ‰“å¼€ç»ˆç«¯ä¼šæç¤º<font color="red">æ²¡æœ‰æ–‡ä»¶æˆ–ç›®å½•æ‰§è¡Œvncviewerå­è¿›ç¨‹</font></strong></p><img src="/2022/10/07/Windows%20Remote%20Linux/fail%20to%20execute.gif" alt="fail to execute" style="zoom:80%;"><p><strong>æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€å®‰è£…å…¶ä»–çš„ç»„ä»¶ï¼Œä»¥æ”¯æŒç»ˆç«¯æ“ä½œé…ç½®</strong></p><p><strong><font color="purple">å®‰è£…å…¶å®ƒç»„ä»¶</font></strong></p><blockquote><p>xfce4-terminal æ˜¯ä¸€ä¸ªè½»é‡çº§å’Œæ˜“äºä½¿ç”¨çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨åº”ç”¨ç¨‹åº</p><p>Tint2 æ˜¯ä¸€ä¸ªè½»é‡çº§é¢æ¿å’Œä»»åŠ¡æ ï¼Œå®ƒå¯ä»¥ä¸ºä»»ä½•çª—å£ç®¡ç†å™¨æä¾›ä¸€è‡´çš„ä½“éªŒ</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- å®‰è£…xfce4-terminal</span><br><span class="line">[root@localhost ~]<span class="comment"># dnf -y install xfce4-terminal</span></span><br><span class="line"></span><br><span class="line">- å®‰è£…tint2.x86_64</span><br><span class="line"><span class="comment"># æ³¨æ„: tint2è½¯ä»¶åŒ…åœ¨é«˜ç‰ˆæœ¬çš„ CentOS Stream9 ä¸‹æ— æ³•å®‰è£…,è¿™æ˜¯ç‰ˆæœ¬è¿‡æ–°çš„é—®é¢˜,æš‚æ—¶æ— æ³•è§£å†³; centos 7 å¯ä»¥å®‰è£…,centos 8 æ²¡è¯•è¿‡</span></span><br><span class="line"><span class="string">&#x27;ä¸è¿‡ä¸å½±å“,åªéœ€xfce-terminalå³å¯é¡ºåˆ©ä½¿ç”¨ç»ˆç«¯äº†&#x27;</span></span><br><span class="line"></span><br><span class="line">- é‡å¯xrdpæœåŠ¡</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl restart xrdp</span></span><br><span class="line"></span><br><span class="line">- å› ä¸ºæ˜¯æœ€å°åŒ–å®‰è£…,é»˜è®¤æ˜¯æ²¡æœ‰firefoxæµè§ˆå™¨,æ‰‹åŠ¨å®‰è£…å³å¯!</span><br><span class="line">[root@localhost ~]<span class="comment"># dnf -y install firefox</span></span><br></pre></td></tr></table></figure><img src="/2022/10/07/Windows%20Remote%20Linux/success.gif" alt="success" style="zoom:80%;">]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šRHEL9ç³»åˆ—ï¼ˆåŒ…æ‹¬rhelï¼‰çš„ç‰ˆæœ¬åœ¨å®‰è£…è½¯ä»¶æ—¶ä¼šå‡ºç°ä¸æˆåŠŸçš„æƒ…å†µï¼Œè¿™åº”è¯¥å’Œ rhel çš„é»˜è®¤æºå’Œè®¢é˜…æœ‰å…³ï¼›&lt;/p&gt;
&lt;p&gt;åœ¨ CentOS å’Œ CentOS Stream ç³»åˆ—ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæœ€å°åŒ–å®‰è£…å’Œå›¾å½¢åŒ–å®‰è£…ï¼ˆGUIï¼‰éƒ½å¯ä»¥é…ç½®&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æœ¬æ¬¡å®éªŒä½¿ç”¨çš„æ˜¯æœ€å°åŒ–å®‰è£…ï¼Œæ— å›¾å½¢ç•Œé¢&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;a href=&quot;#å‡†å¤‡å·¥ä½œ&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;/a&gt;å‡†å¤‡å·¥ä½œ&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;é…ç½®ç½‘ç»œï¼Œèƒ½ä¸Šå¤–ç½‘ &lt;/li&gt;
&lt;/ol&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;é…ç½® aliyun çš„ epel æºï¼Œé“¾æ¥ &lt;a href=&quot;http://www.aliyun.com/&quot;&gt;www.aliyun.com&lt;/a&gt; ï¼Œæœç´¢ epel&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="RDP" scheme="https://laijune.github.io/categories/RDP/"/>
    
    
    <category term="xrdp" scheme="https://laijune.github.io/tags/xrdp/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ </title>
    <link href="https://laijune.github.io/2022/07/14/Machine%20learning/"/>
    <id>https://laijune.github.io/2022/07/14/Machine%20learning/</id>
    <published>2022-07-14T12:00:03.000Z</published>
    <updated>2022-11-15T06:21:58.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼ -tensorflow-é•œåƒ"><a href="#æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼ -tensorflow-é•œåƒ" class="headerlink" title="æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼  tensorflow é•œåƒ"></a>æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼  tensorflow é•œåƒ</h4><p><strong>â‘  é…ç½®ç½‘ç»œï¼Œèƒ½è¿é€šå¤–ç½‘</strong></p><p><strong>â‘¡ å®‰è£…docker</strong></p><p>å‚è€ƒä¸Šç¯‡çš„äº‘å®¹å™¨å¹³å°å®æˆ˜ï¼Œæ­¤å¤„çœç•¥ã€‚ã€‚ã€‚</p><span id="more"></span><p><strong>â‘¢ ccç½‘ä¸‹è½½<code> images.zip</code>æ–‡ä»¶ï¼Œä¸Šä¼ <code> images</code>æ–‡ä»¶</strong>ï¼ˆ<code>scp</code>ï¼Œ<code>WinSCP</code>ï¼Œ<code>XFTP</code>ï¼Œ<code>SecureCRT</code>)</p><p>â€‹    å…ˆåœ¨ç‰©ç†æœºè§£å‹ï¼Œå†ä¸Šä¼ <code>image</code>æ–‡ä»¶   ğŸ‘‡</p><p>â€‹    <code>scp -r images root@192.168.169.10:/root</code></p><p><strong>â‘£ å°†<code>registry_latest.tar</code>æ˜ åƒå¯¼å…¥</strong>     </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># docker load -i images/registry_latest.tar</span></span><br><span class="line">æŸ¥çœ‹registryæ˜ åƒ</span><br><span class="line">[root@localhost ~]<span class="comment"># docker images</span></span><br></pre></td></tr></table></figure><p><strong>â‘¤åˆ›å»ºä¸€ä¸ª registry å®¹å™¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># docker run -d --name registry -v /opt/registry:/var/lib/registry -p 5000:5000 --restart=always registry:latest</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å®¹å™¨</span><br><span class="line">[root@localhost ~]<span class="comment"># docker ps</span></span><br></pre></td></tr></table></figure><p><strong>â‘¥ é…ç½®ä»“åº“åœ°å€</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vim /etc/docker/daemon.json</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="string">&quot;insecure-registries&quot;</span>: [<span class="string">&quot;192.168.169.10:5000&quot;</span>]<span class="comment"># è™šæ‹ŸæœºIP:5000</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">é‡æ–°åŠ è½½æ¨¡å—ã€é‡å¯docker</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl restart docker</span></span><br><span class="line"></span><br><span class="line">è®¿é—®æµ‹è¯•</span><br><span class="line">[root@localhost ~]<span class="comment"># curl http://192.168.169.10:5000/v2</span></span><br><span class="line">&lt;a href=<span class="string">&quot;/v2/&quot;</span>&gt;Moved Permanently&lt;/a&gt;.</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># curl http://192.168.169.10:5000/v2/_catalog</span></span><br><span class="line">&#123;<span class="string">&quot;repositories&quot;</span>:[]&#125;</span><br></pre></td></tr></table></figure><p><strong>â‘¦ ä¸Šä¼  TensorFlow é•œåƒ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½tensorflowé•œåƒ</span><br><span class="line">[root@localhost ~]<span class="comment"># docker pull daocloud.io/daocloud/tensorflow:1.14.0-py3-jupyter</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹tensorflowé•œåƒ</span><br><span class="line">[root@localhost ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY                        TAG                  IMAGE ID            CREATED             SIZE</span><br><span class="line">daocloud.io/daocloud/tensorflow   1.14.0-py3-jupyter   fe3f97fcb6ce        3 years ago         1.34 GB</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">ç»™tensorflowæ‰“æ ‡ç­¾</span><br><span class="line">[root@localhost ~]<span class="comment"># docker tag daocloud.io/daocloud/tensorflow:1.14.0-py3-jupyter 192.168.169.10:5000/tensorflow</span></span><br><span class="line"></span><br><span class="line">ä¸Šä¼ é•œåƒåˆ°ç§æœ‰ä»“åº“</span><br><span class="line">[root@localhost ~]<span class="comment"># docker push 192.168.169.10:5000/tensorflow</span></span><br></pre></td></tr></table></figure><p><strong>â‘§ è®¿é—®æµ‹è¯•</strong></p><p>æµè§ˆå™¨ <code>http://192.168.169.10:5000/v2/_catalog</code>    </p><img src="/2022/07/14/Machine%20learning/image-20220713004722801.png" alt="image-20220713004722801" style="zoom: 80%;"><h4 id="è¯†åˆ«æ‰‹å†™æ•°å­—"><a href="#è¯†åˆ«æ‰‹å†™æ•°å­—" class="headerlink" title="è¯†åˆ«æ‰‹å†™æ•°å­—"></a>è¯†åˆ«æ‰‹å†™æ•°å­—</h4><hr><p><strong>â‘  åˆ›å»º tensorflow å®¹å™¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># docker run -it --name my-tensorflow -p 8888:8888 -v ~/tensorflow:/test/data daocloud.io/daocloud/tensorflow:1.14.0-py3-jupyter </span></span><br><span class="line">...output omitted...</span><br><span class="line">    Or copy and <span class="built_in">paste</span> one of these URLs:</span><br><span class="line">        http://(480dd667b304 or 127.0.0.1):8888/?token=a6a8f826b5fc2e2142bd2643930b68bebf6ae790e53cd1d8</span><br><span class="line"></span><br><span class="line">è®¿é—® ğŸ‘‰ http://<span class="string">&#x27;IPåœ°å€&#x27;</span>:8888/?token=a6a8f826b5fc2e2142bd2643930b68bebf6ae790e53cd1d8</span><br></pre></td></tr></table></figure><p>![image-20220713093014367](Machine learning/image-20220713093014367.png)</p><p><strong>â‘¡ ä¸Šä¼ <code>mnist.npz</code>å’Œ<code>æ‰‹å†™æ•°å­—</code></strong> </p><img src="/2022/07/14/Machine%20learning/image-20220713094229703.png" alt="image-20220713094229703" style="zoom:50%;"><p><strong>â‘¢ ç¼–å†™æ¨¡æ‹Ÿè®­ç»ƒç¨‹åº</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data=np.load(<span class="string">&#x27;mnist.npz&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x_train,y_train,x_test,y_test=data[<span class="string">&#x27;x_train&#x27;</span>],data[<span class="string">&#x27;y_train&#x27;</span>],data[<span class="string">&#x27;x_test&#x27;</span>],data[<span class="string">&#x27;y_test&#x27;</span>]</span><br><span class="line"></span><br><span class="line">x_train = tf.keras.utils.normalize(x_train,axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">x_test = tf.keras.utils.normalize(x_test,axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">model = tf.keras.models.Sequential()</span><br><span class="line"></span><br><span class="line">model.add(tf.keras.layers.Flatten(input_shape=(<span class="number">28</span>,<span class="number">28</span>)))</span><br><span class="line">model.add(tf.keras.layers.Dense(<span class="number">999</span>,activation=tf.nn.relu))</span><br><span class="line">model.add(tf.keras.layers.Dense(<span class="number">999</span>,activation=tf.nn.relu))</span><br><span class="line">model.add(tf.keras.layers.Dense(<span class="number">10</span>,activation=tf.nn.softmax))</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">             loss=<span class="string">&#x27;sparse_categorical_crossentropy&#x27;</span>,</span><br><span class="line">             metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">model.fit(x_train,y_train,epochs=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">val_loss,val_acc=model.evaluate(x_test,y_test)</span><br><span class="line"><span class="built_in">print</span>(val_loss)</span><br><span class="line"><span class="built_in">print</span>(val_acc)</span><br><span class="line"></span><br><span class="line">model.save(<span class="string">&#x27;my_model.h5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">model.summary()</span><br></pre></td></tr></table></figure><p><strong>â‘£ å®‰è£…imageio</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade pip</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install imageio -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure><p><strong>â‘¤ å¯¼å…¥æµ‹è¯•å›¾ç‰‡</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">img_data = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> image_file_name <span class="keyword">in</span> glob.glob(<span class="string">&#x27;img_?.jpg&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;loading ...&quot;</span>,image_file_name)</span><br><span class="line">        img_array = imageio.imread(image_file_name,as_gray=<span class="literal">True</span>)</span><br><span class="line">        img_data.append((<span class="number">255.0</span> - img_array.reshape(<span class="number">784</span>)) / <span class="number">255.0</span>)</span><br><span class="line">        self_data = np.array(img_data).reshape(<span class="built_in">len</span>(img_data),<span class="number">28</span>,<span class="number">28</span>)</span><br></pre></td></tr></table></figure><p><strong>â‘¥ è¿›è¡Œé¢„æµ‹</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">pre = model.predict(self_data)</span><br><span class="line">predit=[<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">predit[<span class="number">0</span>]=np.argmax(pre[<span class="number">9</span>])</span><br><span class="line">predit[<span class="number">1</span>]=np.argmax(pre[<span class="number">8</span>])</span><br><span class="line">predit[<span class="number">2</span>]=np.argmax(pre[<span class="number">7</span>])</span><br><span class="line">predit[<span class="number">3</span>]=np.argmax(pre[<span class="number">6</span>])</span><br><span class="line">predit[<span class="number">4</span>]=np.argmax(pre[<span class="number">5</span>])</span><br><span class="line">predit[<span class="number">5</span>]=np.argmax(pre[<span class="number">4</span>])</span><br><span class="line">predit[<span class="number">6</span>]=np.argmax(pre[<span class="number">3</span>])</span><br><span class="line">predit[<span class="number">7</span>]=np.argmax(pre[<span class="number">2</span>])</span><br><span class="line">predit[<span class="number">8</span>]=np.argmax(pre[<span class="number">1</span>])</span><br><span class="line">predit[<span class="number">9</span>]=np.argmax(pre[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(predit)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼ -tensorflow-é•œåƒ&quot;&gt;&lt;a href=&quot;#æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼ -tensorflow-é•œåƒ&quot; class=&quot;headerlink&quot; title=&quot;æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼  tensorflow é•œåƒ&quot;&gt;&lt;/a&gt;æ­å»ºç§æœ‰ä»“åº“ï¼Œä¸Šä¼  tensorflow é•œåƒ&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;â‘  é…ç½®ç½‘ç»œï¼Œèƒ½è¿é€šå¤–ç½‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;â‘¡ å®‰è£…docker&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å‚è€ƒä¸Šç¯‡çš„äº‘å®¹å™¨å¹³å°å®æˆ˜ï¼Œæ­¤å¤„çœç•¥ã€‚ã€‚ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://laijune.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
    <category term="Docker" scheme="https://laijune.github.io/tags/Docker/"/>
    
    <category term="TensorFlow" scheme="https://laijune.github.io/tags/TensorFlow/"/>
    
  </entry>
  
  <entry>
    <title>äº‘AIå¹³å°å®æˆ˜</title>
    <link href="https://laijune.github.io/2022/07/07/Cloud%20AI/"/>
    <id>https://laijune.github.io/2022/07/07/Cloud%20AI/</id>
    <published>2022-07-07T12:00:02.000Z</published>
    <updated>2022-11-15T06:16:20.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åˆ¶ä½œå¾®ä¿¡åç‰‡"><a href="#åˆ¶ä½œå¾®ä¿¡åç‰‡" class="headerlink" title="åˆ¶ä½œå¾®ä¿¡åç‰‡"></a>åˆ¶ä½œå¾®ä¿¡åç‰‡</h3><hr><p><strong>åˆå§‹ç¯å¢ƒï¼Œé…ç½®ç½‘ç»œï¼Œèƒ½ PING é€šå¤–ç½‘</strong></p><p><strong>é…ç½® YUM æº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># mkdir /dvd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mount /dev/sr0 /dvd/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/yum.repos.d/local.repo</span></span><br><span class="line">[<span class="built_in">local</span>]</span><br><span class="line">name = This is <span class="built_in">local</span> repo</span><br><span class="line">baseurl = file:///dvd</span><br><span class="line">enabled = 1</span><br><span class="line">gpgcheck = 0</span><br><span class="line">[root@localhost ~]<span class="comment"># yum clean all</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum repolist</span></span><br></pre></td></tr></table></figure><span id="more"></span><p><strong>å®‰è£…è½¯ä»¶åŒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># yum -y install epel-release</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum -y install python36 python36u-pip python36u-redis python36-numpy</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum -y install python36-devel</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum -y install zlib-devel</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum -y install libjpeg-turbo-devel</span></span><br></pre></td></tr></table></figure><p><strong>é…ç½® pip</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># mkdir .pip</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cd .pip/</span></span><br><span class="line">[root@localhost .pip]<span class="comment"># vim pip.conf</span></span><br><span class="line">[global]</span><br><span class="line">index-url=https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">trusted-host=pypi.tuna.tsinghua.edu.cn</span><br><span class="line"></span><br><span class="line">å®‰è£…gcc,ä»¥å…å®‰è£…MyQRæŠ¥é”™</span><br><span class="line">[root@localhost .pip]<span class="comment"># yum -y install gcc* </span></span><br><span class="line">å®‰è£…MyQR</span><br><span class="line">[root@localhost .pip]<span class="comment"># pip3 install MyQR</span></span><br></pre></td></tr></table></figure><p><strong>å®‰è£… zbarã€pyzbarã€pillow</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost .pip]<span class="comment"># cd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># yum -y install zbar</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pip3 install pyzbar pillow</span></span><br></pre></td></tr></table></figure><p><strong>ç¼–å†™å¾®ä¿¡åç‰‡å›¾åƒè§£ç ç¨‹åº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;æ–‡ä»¶å&#x27;</span>æ— æ‰€è°“,ä»¥.pyç»“å°¾</span><br><span class="line">[root@localhost ~]<span class="comment"># vim decode.py</span></span><br><span class="line">from pyzbar.pyzbar import decode</span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">image=<span class="string">&quot;wx.jpg&quot;</span><span class="comment"># è¿™é‡Œå›¾ç‰‡è·¯å¾„åœ¨å½“å‰ç›®å½• /root/ ç›®å½•ä¸‹,æ³¨æ„æ–‡ä»¶åå’Œæ ¼å¼è¦ä¸€è‡´;ç‰©ç†æœºçš„è¯å»ºè®®scp</span></span><br><span class="line">img = Image.open(image)</span><br><span class="line">barcodes = decode(img)</span><br><span class="line"><span class="keyword">for</span> barcode <span class="keyword">in</span> barcodes:</span><br><span class="line">        url = barcode.data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(url)</span><br><span class="line">        </span><br><span class="line">[root@localhost ~]<span class="comment"># python3 decode.py </span></span><br><span class="line">https://u.wechat.com/MFSMySpvW2Ec2mJUjK7cn0M        <span class="comment"># è·å¾—è¾“å‡ºé“¾æ¥,å¤åˆ¶</span></span><br></pre></td></tr></table></figure><p><strong>ç¼–å†™å¾®ä¿¡ä»£ç </strong></p><p>åŠ¨æ€å›¾ç‰‡èƒŒæ™¯<strong>ï¼ˆgifï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;æ–‡ä»¶å&#x27;</span>æ— æ‰€è°“,ä»¥.pyç»“å°¾</span><br><span class="line"><span class="comment"># åŸå›¾ç‰‡è·¯å¾„(picture)åœ¨/root/Desktop/222.gif</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vim myqr_wx2.py</span></span><br><span class="line">from MyQR import myqr</span><br><span class="line">myqr.run(words=<span class="string">&quot;https://u.wechat.com/MFSMySpvW2Ec2mJUjK7cn0M&quot;</span>,version=3,picture=<span class="string">&quot;/root/Desktop/222.gif&quot;</span>,colorized=True,</span><br><span class="line">        save_name=<span class="string">&quot;233.gif&quot;</span>,æ³¨æ„è¿™é‡Œçš„åç¼€åªèƒ½æ˜¯<span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;.png&#x27;</span>, <span class="string">&#x27;.bmp&#x27;</span>, <span class="string">&#x27;.gif&#x27;</span>,å»ºè®®<span class="string">&#x27;.gif&#x27;</span></span><br><span class="line">        save_dir=<span class="string">&quot;/root/Desktop&quot;</span>)è¾“å‡ºè·¯å¾„</span><br><span class="line"></span><br><span class="line">è¿™é‡Œç›´æ¥æ‰§è¡Œpyæ–‡ä»¶å¯èƒ½ç”±äºnumpyç‰ˆæœ¬è¿‡é«˜æŠ¥é”™,éœ€è¦å®‰è£…ä½ç‰ˆæœ¬</span><br><span class="line">[root@localhost ~]<span class="comment"># pip3 install imageio==2.13.5</span></span><br><span class="line">å†æ¬¡æ‰§è¡Œpyæ–‡ä»¶</span><br><span class="line">[root@localhost ~]<span class="comment"># python3 myqr_wx2.py</span></span><br><span class="line">line 16: mode: byte</span><br></pre></td></tr></table></figure><h3 id="æ ‡è¯†äººè„¸ç‰¹å¾"><a href="#æ ‡è¯†äººè„¸ç‰¹å¾" class="headerlink" title="æ ‡è¯†äººè„¸ç‰¹å¾"></a>æ ‡è¯†äººè„¸ç‰¹å¾</h3><hr><p><strong>å®‰è£…ç¯å¢ƒ</strong></p><p><code>åœ¨Pythonå®˜ç½‘ä¸‹è½½ python-3.6.6-amd64.exe,å¦‚æœæœ‰å…¶å®ƒç‰ˆæœ¬è®°å¾—å…ˆå¸è½½</code></p><img src="/2022/07/07/Cloud%20AI/image-20220711220012434.png" alt="image-20220711220012434" style="zoom:50%;"><p><strong>ä»¥ä¸‹å‘½ä»¤åœ¨cmdæ“ä½œ</strong>        ğŸ‘‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æ£€éªŒ python</span><br><span class="line">C:\Users\Lai&gt;python --version</span><br><span class="line">Python 3.6.6ğŸ‘ˆ ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">åœ¨å½“å‰ç›®å½•æ–°å»ºpipæ–‡ä»¶å¤¹,å†™ä¸€ä¸ª<span class="string">&#x27;pip.ini&#x27;</span>æ–‡ä»¶</span><br><span class="line"><span class="comment"># å†…å®¹å¦‚ä¸‹,æ³¨æ„æ‰©å±•åæ˜¯ini</span></span><br><span class="line">[global]</span><br><span class="line">index-url=https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host=pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure><img src="/2022/07/07/Cloud%20AI/2.png" alt="2" style="zoom: 67%;"><p><strong>å®‰è£…äººè„¸æ£€æµ‹ç›¸å…³çš„åŒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½ Pillow</span><br><span class="line">C:\Users\Lai&gt;pip install Pillow==7.0.0 -i https://pypi.tuna.tsinghua.edu.cn/simple/</span><br><span class="line"></span><br><span class="line">å®‰è£… CMake</span><br><span class="line">C:\Users\Lai&gt;pip install CMake</span><br><span class="line"></span><br><span class="line">å®‰è£… dlib</span><br><span class="line">C:\Users\Lai&gt;pip install dlib==19.8.1</span><br><span class="line"></span><br><span class="line">å®‰è£… face_recognition</span><br><span class="line">C:\Users\Lai&gt;pip install face_recognition</span><br></pre></td></tr></table></figure><p><strong>ç¼–å†™äººè„¸è¯†åˆ«ç‰¹å¾ç¨‹åº</strong></p><p><code>å†™ä¸€ä¸ªface_1.pyæ–‡ä»¶,å†…å®¹å¦‚ä¸‹    ğŸ‘‡</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import face_recognition</span><br><span class="line"></span><br><span class="line">from PIL import Image,ImageDraw</span><br><span class="line"></span><br><span class="line">image = face_recognition.load_image_file(<span class="string">&quot;G312xixi.jpg&quot;</span>)</span><br><span class="line"></span><br><span class="line">face_landmarks_list = face_recognition.face_landmarks(image)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I found &#123;&#125; face(s) in this photograph.&quot;</span>.format(len(face_landmarks_list)))</span><br><span class="line"></span><br><span class="line">pil_image = Image.fromarray(image)</span><br><span class="line">d = ImageDraw.Draw(pil_image)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> face_landmarks <span class="keyword">in</span> face_landmarks_list:</span><br><span class="line"><span class="keyword">for</span> facial_feature <span class="keyword">in</span> face_landmarks.keys():</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;The &#123;&#125; in this face has the following points:&#123;&#125;&quot;</span>.format(facial_feature,face_landmarks[facial_feature]))</span><br><span class="line"><span class="keyword">for</span> facial_feature <span class="keyword">in</span> face_landmarks.keys():</span><br><span class="line">d.line(face_landmarks[facial_feature],width=5)</span><br><span class="line"></span><br><span class="line">pil_image.show()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºå³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Lai&gt;python face_1.py</span><br></pre></td></tr></table></figure><img src="/2022/07/07/Cloud%20AI/1.png" alt="image-20220711230350855" style="zoom: 80%;">]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;åˆ¶ä½œå¾®ä¿¡åç‰‡&quot;&gt;&lt;a href=&quot;#åˆ¶ä½œå¾®ä¿¡åç‰‡&quot; class=&quot;headerlink&quot; title=&quot;åˆ¶ä½œå¾®ä¿¡åç‰‡&quot;&gt;&lt;/a&gt;åˆ¶ä½œå¾®ä¿¡åç‰‡&lt;/h3&gt;&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;åˆå§‹ç¯å¢ƒï¼Œé…ç½®ç½‘ç»œï¼Œèƒ½ PING é€šå¤–ç½‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é…ç½® YUM æº&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# mkdir /dvd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# mount /dev/sr0 /dvd/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# vim /etc/yum.repos.d/local.repo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name = This is &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt; repo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;baseurl = file:///dvd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;enabled = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gpgcheck = 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# yum clean all&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# yum repolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://laijune.github.io/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
    <category term="Python" scheme="https://laijune.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>äº‘å®¹å™¨å¹³å°å®æˆ˜</title>
    <link href="https://laijune.github.io/2022/07/01/Cloud%20Container/"/>
    <id>https://laijune.github.io/2022/07/01/Cloud%20Container/</id>
    <published>2022-07-01T12:00:01.000Z</published>
    <updated>2022-11-16T15:23:52.000Z</updated>
    
    <content type="html"><![CDATA[<p><code>åˆå§‹å¿«ç…§</code></p><h5 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h5><p>â‘ éƒ¨ç½² IPï¼Œèƒ½è”é€šå¤–ç½‘</p><p>â‘¡æ¸…é™¤é˜²ç«å¢™è§„åˆ™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># iptables -F</span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -X</span></span><br><span class="line">[root@localhost ~]<span class="comment"># iptables -Z</span></span><br><span class="line">[root@localhost ~]<span class="comment"># /usr/sbin/iptables-save</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/selinux/config </span></span><br><span class="line">...</span><br><span class="line">SELINUX=disabledå°†enforcingæ”¹æˆdisabled</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure><span id="more"></span><p>â‘¢å…³é—­ swap äº¤æ¢åˆ†åŒº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># swapoff -a</span></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/fstab </span></span><br><span class="line">...</span><br><span class="line"><span class="comment">#/dev/mapper/centos-swap swap                    swap    defaults        0 0</span></span><br><span class="line">æ³¨é‡Šè¿™ä¸€è¡Œâ†‘</span><br></pre></td></tr></table></figure><p>â‘£è·¯ç”±è½¬å‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vim /etc/sysctl.conf </span></span><br><span class="line">...æ·»åŠ ä»¥ä¸‹ä¸‰è¡Œâ†“</span><br><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line"></span><br><span class="line">åŠ è½½æ¨¡å—</span><br><span class="line">[root@localhost ~]<span class="comment"># modprobe br_netfilter</span></span><br><span class="line">ä»åˆšåˆšå†™çš„æ–‡ä»¶é‡Œè¯»å–å€¼</span><br><span class="line">[root@localhost ~]<span class="comment"># sysctl -p</span></span><br></pre></td></tr></table></figure><p>â‘¤ç‰©ç†æœº scp ä¸Šä¼ <code>Kubernetes.zip</code>æ–‡ä»¶</p><p>å†è§£å‹.zipæ–‡ä»¶</p><p><code>[root@localhost ~]# unzip Kubernetes.zip </code></p><p>â‘¥å…ˆå¤‡ä»½<code>/etc/yum.repos.d/</code>ä¸‹çš„æ‰€æœ‰ Centos-xxx æ–‡ä»¶ï¼Œå†é…ç½®æœ¬åœ° yum æºï¼ˆåªç•™è¿™ä¸€ä¸ªæ–‡ä»¶ï¼‰</p><p>â‘¦é‡å¯æœåŠ¡</p><p><code>[root@localhost Kubernetes]# systemctl restart network</code></p><p>â‘§å®‰è£… docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># yum -y install docker*</span></span><br><span class="line"></span><br><span class="line">å¯åŠ¨dockeræœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl start docker ; systemctl enable docker</span></span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹dockerä¿¡æ¯</span><br><span class="line">[root@localhost ~]<span class="comment"># docker info</span></span><br><span class="line"></span><br><span class="line">é‡å¯åŠ è½½æœåŠ¡</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl daemon-reload </span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl start docker ; systemctl enable docker</span></span><br></pre></td></tr></table></figure><h5 id="éƒ¨ç½²-MySQL-å®¹å™¨"><a href="#éƒ¨ç½²-MySQL-å®¹å™¨" class="headerlink" title="éƒ¨ç½² MySQL å®¹å™¨"></a>éƒ¨ç½² MySQL å®¹å™¨</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">æ‹‰å–mysqlæ˜ åƒ</span><br><span class="line">[root@localhost ~]<span class="comment"># docker pull mysql</span></span><br><span class="line"></span><br><span class="line">åˆ›å»ºmysqlå®¹å™¨</span><br><span class="line">[root@localhost ~]<span class="comment"># docker run -d -e MYSQL_ROOT_PASSWORD=123456 -p 3306:3306 --name db_mysql_wordpress mysql</span></span><br><span class="line"></span><br><span class="line">è¿›å…¥mysqlå®¹å™¨,æŒ‰é¢˜ç›®è¦æ±‚åˆ›å»ºæ•°æ®åº“å’Œè¡¨</span><br><span class="line">[root@localhost ~]<span class="comment"># docker exec -it db_mysql_wordpress /bin/bash</span></span><br><span class="line">bash-4.4<span class="comment"># mysql -uroot -p123456</span></span><br><span class="line"></span><br><span class="line">mysql&gt; create database SZPT;</span><br><span class="line">mysql&gt; use SZPT;</span><br><span class="line">mysql&gt; create table Cloud(stuno varchar(8),stuname varchar(8),stulaojia varchar(8),stuage varchar(2));</span><br><span class="line">mysql&gt; insert into Cloud(stuno,stuname,stulaojia,stuage) values</span><br><span class="line">    -&gt; (<span class="string">&#x27;20940702&#x27;</span>,<span class="string">&#x27;xiaolai&#x27;</span>,<span class="string">&#x27;meizhou&#x27;</span>,<span class="string">&#x27;20&#x27;</span>),</span><br><span class="line">    -&gt; (<span class="string">&#x27;20940715&#x27;</span>,<span class="string">&#x27;xiaoding&#x27;</span>,<span class="string">&#x27;hunan&#x27;</span>,<span class="string">&#x27;20&#x27;</span>),    </span><br><span class="line">    -&gt; (<span class="string">&#x27;20940700&#x27;</span>,<span class="string">&#x27;zhiquan&#x27;</span>,<span class="string">&#x27;maoming&#x27;</span>,<span class="string">&#x27;21&#x27;</span>),</span><br><span class="line">    -&gt; (<span class="string">&#x27;20940688&#x27;</span>,<span class="string">&#x27;youjun&#x27;</span>,<span class="string">&#x27;shenzhen&#x27;</span>,<span class="string">&#x27;20&#x27;</span>),</span><br><span class="line">    -&gt; (<span class="string">&#x27;20940676&#x27;</span>,<span class="string">&#x27;xiaopan&#x27;</span>,<span class="string">&#x27;zhuhai&#x27;</span>,<span class="string">&#x27;20&#x27;</span>),</span><br><span class="line">    -&gt; (<span class="string">&#x27;18240683&#x27;</span>,<span class="string">&#x27;xixi&#x27;</span>,<span class="string">&#x27;shenzhen&#x27;</span>,<span class="string">&#x27;22&#x27;</span>),</span><br><span class="line">    -&gt; (<span class="string">&#x27;20940680&#x27;</span>,<span class="string">&#x27;cc&#x27;</span>,<span class="string">&#x27;shenzhen&#x27;</span>,<span class="string">&#x27;19&#x27;</span>);</span><br><span class="line">mysql&gt; select * from Cloud <span class="built_in">where</span> Cloud.stuage=<span class="string">&#x27;20&#x27;</span>;<span class="string">&#x27;æœ¬äººå¹´é¾„&#x27;</span></span><br><span class="line">    </span><br><span class="line">é€€å‡º(<span class="built_in">exit</span>)</span><br><span class="line">å¯¼å‡º<span class="string">&#x27;mysql&#x27;</span>æ˜ åƒtaråŒ…</span><br><span class="line">[root@localhost ~]<span class="comment"># docker save -o mysql.tar mysql</span></span><br></pre></td></tr></table></figure><h5 id="å®‰è£…-wordpress"><a href="#å®‰è£…-wordpress" class="headerlink" title="å®‰è£… wordpress"></a>å®‰è£… wordpress</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ‹‰å–wordpressæ˜ åƒ</span><br><span class="line">[root@localhost ~]<span class="comment"># docker pull wordpress</span></span><br><span class="line"></span><br><span class="line">åˆ›å»ºwordpresså®¹å™¨</span><br><span class="line">[root@localhost ~]<span class="comment"># docker run -d --link db_mysql_wordpress -p 9090:80 --name wb_wordpress wordpress</span></span><br><span class="line"></span><br><span class="line">å…³é—­é˜²ç«å¢™</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl stop firewalld</span></span><br></pre></td></tr></table></figure><p><strong>æµè§ˆå™¨è®¿é—®å³å¯</strong></p><p>IPåœ°å€/9090</p><img src="/2022/07/01/Cloud%20Container/image-20220709205122302.png" alt="image-20220709205122302" style="zoom:50%;"><p>åç»­æ ¹æ®éœ€æ±‚ post åšå®¢å³å¯~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;code&gt;åˆå§‹å¿«ç…§&lt;/code&gt;&lt;/p&gt;
&lt;h5 id=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;a href=&quot;#å‡†å¤‡å·¥ä½œ&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡å·¥ä½œ&quot;&gt;&lt;/a&gt;å‡†å¤‡å·¥ä½œ&lt;/h5&gt;&lt;p&gt;â‘ éƒ¨ç½² IPï¼Œèƒ½è”é€šå¤–ç½‘&lt;/p&gt;
&lt;p&gt;â‘¡æ¸…é™¤é˜²ç«å¢™è§„åˆ™&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# iptables -F&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# iptables -X&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# iptables -Z&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# /usr/sbin/iptables-save&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# vim /etc/selinux/config &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SELINUX=disabled		å°†enforcingæ”¹æˆdisabled&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@localhost ~]&lt;span class=&quot;comment&quot;&gt;# reboot&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="äº‘åŸç”Ÿ" scheme="https://laijune.github.io/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
    
    
    <category term="Docker" scheme="https://laijune.github.io/tags/Docker/"/>
    
  </entry>
  
</feed>
